<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>PÁGINA REGISTRO MERCADONA</title>
    <style>
        body {
            font-family: Calibri;
            background-color: #008000;
        }

        .tablaRegistro {
            width: 100%;
            background-color: #ffffff;
        }

        .tablaDirecciones .tablaTelefonos {
            width: 100%;
            background-color: #ffffff;
            padding: 20px;
        }

        .titulo {
            color: #008000;
            font-size: larger;
            font-weight: bold;
        }

        .campoObligatorio {
            color: #660000;
        }

        .texto {
            color: #008000;
        }

        .textoPop {
            color: #004d00;
            font: bold 15px Calibri;
        }

        .botones {
            border: 2px solid #008000;
            font: bold 15px Calibri;
        }

        #formuRegistro .error {
            color: red;
        }

        #formuRegistro .valid {
            color: #008000;
        }
    </style>
    <script src="\Scripts\jquery-2.1.4.js"></script>
    <script src="\Scripts\jquery.validate.js"></script>
    <script src="\Scripts\combodate.js"></script>
    <script src="\Scripts\moment.js"></script>
    <script src="\Scripts\moment-with-locales.js"></script>
    <script src="\Scripts\jquery.magnific-popup.js"></script>
    <script src="\Scripts\zepto.min.js"></script>
    <link href="Content/magnific-popup.css" rel="stylesheet" />
    <meta charset="utf-8" />
</head>
<body>
    <form id="formuRegistro" name="formuRegistro">
        <div style="height: 100px"></div>
        <div>
            <table class="tablaRegistro">
                <tr>
                    <td colspan="3" style="background-color: #ffad33; height: 30px">
                        <label for="titulo" class="titulo">FICHA DE ALTA DE CLIENTE</label>
                    </td>
                </tr>
                <tr>
                    <td colspan="3">
                        <label for="campoObligatorio" class="campoObligatorio">*-Campo Obligarotio</label>
                    </td>
                </tr>
                <tr>
                    <td>
                        <label for="textBoxNombre" class="texto"><span class="campoObligatorio">*</span>-Nombre:</label>
                        <input id="textBoxNombre" name="textBoxNombre" type="text" />
                    </td>
                    <td>
                        <label for="textBoxApellido1" class="texto">-Primer Apellido:</label>
                        <input id="textBoxApellido1" name="textBoxApellido1" type="text" />
                    </td>
                    <td>
                        <label for="textBoxApellido2" class="texto">-Segundo Apellido:</label>
                        <input id="textBoxApellido2" name="textBoxApellido2" type="text" />
                    </td>
                </tr>
                <tr>
                    <td>
                        <label for="tipoID" class="texto"><span class="campoObligatorio">*</span>-Tipo De Identifiacación:</label>

                        <select id="selectID" name="selectID"></select>
                        <!-- CARGA DEL SELECT=>TIPOS DE IDENTIFICACIÓN -->
                        <script>
                            var tiposID = ['DNI', 'Tarjeta Residente', 'Pasaporte', 'CIF']

                            $.each(tiposID, function (i, value) {
                                $('#selectID').append($("<option></option>").val(i).html(value));
                            });
                        </script>

                    </td>
                    <td>
                        <label for="textBoxIdentificacion" class="texto"><span class="campoObligatorio">*</span>-Identificación:</label>
                        <input id="textBoxIdentificacion" name="textBoxIdentificacion" type="text" />
                    </td>
                    <td>
                        <input id="checkBoxRecibirInfo" name="checkBoxRecibirInfo" value="informacion" type="checkbox">Deseo recibir información comercial
                    </td>
                </tr>
                <tr>
                    <td>
                        <label for="textBoxEmail" class="texto"><span class="campoObligatorio">*</span>-Email:</label>
                        <input id="textBoxEmail" name="textBoxEmail" type="email" />
                    </td>
                    <td>
                        <label for="textBoxConfirmaEmail" class="texto"><span class="campoObligatorio">*</span>-Confirmación Email:</label>
                        <input id="textBoxConfirmaEmail" name="textBoxConfirmaEmail" type="email" />

                    </td>
                    <td>
                        <label for="fechaNacimiento" class="texto"><span class="campoObligatorio">*</span>-Fecha de nacimiento:</label>
                        <input id="fechaNacimientoInput" data-format="DD-MM-YYYY" data-template="D MMMM YYYY" name="date" type="text">
                        <script>
                            moment.locale('es');
                            $(function () {
                                $('#fechaNacimientoInput').combodate({
                                    value: new Date(),
                                    minYear: 1900,
                                    maxYear: moment().format('YYYY')
                                });
                            });

                        </script>

                        <!-- CARGA DE FECHA SIN COMBODATE -->
                        <!--<select id="selectDia" name="selectDia"></select>
                        <select id="selectMes" name="selectMes"></select>
                        <select id="selectAnyo" name="selectAnyo"></select>
                        <script>
                            //Meses
                            var mesesYDias = [
                                {
                                    mes: "Enero",
                                    dias: 31
                                },
                                {
                                    mes: "Febrero",
                                    dias: 28
                                },
                                {
                                    mes: "Marzo",
                                    dias: 31
                                },
                                {
                                    mes: "Abril",
                                    dias: 30
                                },
                                {
                                    mes: "Mayo",
                                    dias: 30
                                },
                                {
                                    mes: "Junio",
                                    dias: 30
                                },
                                {
                                    mes: "Julio",
                                    dias: 31
                                },
                                {
                                    mes: "Agosto",
                                    dias: 31
                                },
                                {
                                    mes: "Septiembre",
                                    dias: 30
                                },
                                {
                                    mes: "Octubre",
                                    dias: 31
                                },
                                {
                                    mes: "Noviembre",
                                    dias: 30
                                },
                                {
                                    mes: "Diciembre",
                                    dias: 31
                                },

                            ];

                            $.each(mesesYDias, function (i, value) {
                                $('#selectMes').append($("<option></option>").val(value.mes).html(value.mes));
                            });

                            $('#selectMes').change(function () {
                                var mesSelect = $("#selectMes option:selected").text();
                                $('#selectDia').empty();
                                $.each(mesesYDias, function (i, value) {
                                    if (value.mes == mesSelect) {
                                        var dias = value.dias;

                                        for (var j = 1; j <= dias; j++) {
                                            $('#selectDia').append($("<option></option>").val(j).html(j));
                                        }
                                    }
                                });
                            })

                            for (var k = new Date().getFullYear() ; k > 1900; k--) {
                                $('#selectAnyo').append($("<option></option>").val(k).html(k));
                            }

                        </script>-->

                    </td>
                </tr>
                <tr>
                    <td>
                        <label for="textBoxPass" class="texto"><span class="campoObligatorio">*</span>-Contraseña:</label>
                        <input id="textBoxPass" name="textBoxPass" type="password" />
                    </td>
                    <td>
                        <label for="textBoxConfPass" class="texto"><span class="campoObligatorio">*</span>-Confirmación Contraseña:</label>
                        <input id="textBoxConfPass" name="textBoxConfPass" type="password" />
                    </td>
                </tr>
                <tr style="background-color: #ffffcc">
                    <td>
                        <label for="direcciones" class="texto"><span class="campoObligatorio">*</span>-Direcciones:</label>
                    </td>
                    <td>
                        <select id="selectDirecciones" name="selectDirecciones"></select>
                    </td>
                    <td>
                        <button class="botonAltaD" id="buttonAltaD" href="#formuDirecciones" style="border: 2px solid #008000; font: bold 15px Calibri">Alta</button>

                        <button class="botonModificarD" id="buttonModificarD" name="buttonModificarD" href="#formuDirecciones" style="border: 2px solid #008000; font: bold 15px Calibri">Modificar</button>

                        <input class="botones" id="buttonBajaD" name="buttonBajaD" type="button" value="Baja" />

                    </td>
                </tr>
                <tr style="background-color: #ffffcc">
                    <td>
                        <label for="telefonos" class="texto"><span class="campoObligatorio">*</span>-Teléfonos:</label>
                    </td>
                    <td>
                        <select id="selectTelefonos" name="selectTelefonos"></select>
                    </td>
                    <td>
                        <button class="botonAltaT" id="botonAltaT" href="#formuTelefonos" style="border: 2px solid #008000; font: bold 15px Calibri">Alta</button>

                        <input class="botones" id="buttonModificarT" name="buttonModificarT" type="button" value="Modificar" />
                        <input class="botones" id="buttonBajaT" name="buttonBajaT" type="button" value="Baja" />
                    </td>
                </tr>
                <tr>
                    <td>
                        <label for="faltaProd" class="texto">-En caso de falta de producto:</label>
                        <select id="selectFaltaProd" name="selectFaltaProd"></select>
                        <script>
                            var faltaProd = ['Elija una opción', 'Sustituir por similar', 'No servir']

                            $.each(faltaProd, function (i, value) {
                                $('#selectFaltaProd').append($("<option></option>").val(value).html(value));
                            });
                        </script>

                    </td>
                    <td>
                        <input class="botones" id="buttonEnviarAlta" name="buttonEnviarAlta" type="button" value="Enviar Alta" />
                        <input class="botones" id="buttonCerrar" name="buttonCerrar" type="button" value="Cerrar" />
                    </td>
                    <td></td>
                </tr>
            </table>
        </div>
    </form>

    <!-- <div> popUp Direcciones -->
    <div id="formuDirecciones" class="mfp-hide white-popup-block">
        <form id="formuDirecciones">
            <table class="tablaDirecciones">
                <tr>
                    <td colspan="5" style="background-color: #ffad33; height: 30px">
                        <label for="titulo" class="titulo">FICHA DE ALTA DIRECCIÓN DE ENTREGA</label>
                    </td>
                </tr>
                <tr>
                    <td colspan="5">
                        <label for="campoObligatorio" class="campoObligatorio">*-Campo Obligarotio</label>
                    </td>
                </tr>
                <tr>
                    <td>
                        <label for="tipoVia" class="texto">-Tipo de Vía:</label>
                        <select id="selectVia" name="selectVia"></select>
                        <!-- CARGA DEL SELECT=>TIPOS DE VIA -->
                        <script>
                            var tiposVia = ['Alameda', 'Avenida', 'Calle', 'Edificio', 'Glorieta', 'Paseo', 'Plaza', 'Via', 'Urbanización'];
                            $.each(tiposVia, function (i, value) {
                                $('#selectVia').append($("<option></option>").val(i).html(value));
                            });
                        </script>

                    </td>
                    <td>
                        <label for="textBoxNombreVia" class="texto"><span class="campoObligatorio">*</span>-Nombre Vía:</label>
                        <input id="textBoxNombreVia" name="textBoxNombreVia" type="text" />
                    </td>
                    <td>
                        <label for="textBoxNumero" class="texto">-Nº/Km:</label>
                        <input id="textBoxNumero" name="textBoxNumero" type="text" />
                    </td>
                    <td>
                        <label for="textBoxPiso" class="texto">-Piso:</label>
                        <input id="textBoxPiso" name="textBoxPiso" type="text" />
                    </td>
                    <td>
                        <label for="textBoxPuerta" class="texto">-Puerta:</label>
                        <input id="textBoxPuerta" name="textBoxPuerta" type="text" />
                    </td>
                </tr>
                <tr>
                    <td>
                        <label for="textBoxLocalidad" class="texto"><span class="campoObligatorio">*</span>-Localidad:</label>
                        <input id="textBoxLocalidad" name="textBoxLocalidad" type="text" />
                    </td>

                    <td>
                        <label for="textBoxCP" class="texto">-Código Postal:</label>
                        <input id="textBoxCP" name="textBoxCP" type="text" />
                    </td>
                </tr>
                <tr>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td>
                        <input class="botones" id="buttonAceptarD" name="buttonAceptar" type="button" value="Aceptar" />
                        <input class="botones" id="buttonCancelarD" name="buttonCancelar" type="button" value="Cancelar" />
                    </td>
                </tr>
            </table>
        </form>
    </div>
    <script>
        $.fn.reset = function () {
            $("#formuDirecciones").find(':text').each(function () {
                var elemento = this;
                elemento.value = "";
            });
        };

        $.fn.cargaArray = function () {
            var direccion = []

            if ($("#textBoxNombreVia").val() != "" && $("#textBoxLocalidad").val() != "") { //Compruebo si los campos obligatorios están rellenos
                direccion.length = 0; //Limpio el array dirección, por si anteriormente hubiera dado de alta una direccion

                var tipoVia = $("#selectVia option:selected").text();
                direccion.push({
                    key: "tipoVia",
                    value: tipoVia
                });

                $("#formuDirecciones").find(':text').each(function () {
                    var elemento = this;
                    switch (elemento.id) {

                        case "textBoxNombreVia": {
                            direccion.push({
                                key: "nombreVia",
                                value: " " + elemento.value
                            });
                            break;
                        }

                        case "textBoxNumero": {
                            if (elemento.value != "") {
                                direccion.push({
                                    key: "numero",
                                    value: " " + elemento.value
                                });
                            }
                            break;
                        }

                        case "textBoxPiso": {
                            if (elemento.value != "") {
                                direccion.push({
                                    key: "piso",
                                    value: " " + elemento.value
                                });
                            }
                            break;
                        }
                        case "textBoxPuerta": {
                            if (elemento.value != "") {
                                direccion.push({
                                    key: "puerta",
                                    value: " " + elemento.value
                                });
                            }
                            break;
                        }

                        case "textBoxLocalidad": {
                            direccion.push({
                                key: "localidad",
                                value: " " + elemento.value
                            });
                            break;
                        }

                        case "textBoxCP": {
                            if (elemento.value != "") {
                                direccion.push({
                                    key: "CP",
                                    value: " " + elemento.value + ":"
                                });
                            }
                            break;
                        }
                    }
                });
            } else {
                window.alert("Los campos obligatorios deben ser rellenados");
            }

            return direccion;
        }
    </script>
    <script>
        var direccionesUsuario = [];

        $('.botonAltaD').magnificPopup({
            type: 'inline',
            preloader: false,
            modal: true
        });

        $('.botonModificarD').click(function () {
            $('#formuDirecciones').reset();
            var direccionSeleccionada = $("#selectDirecciones option:selected").text();

            var dir = "";
            $.each(direccionesUsuario, function (index, value) {
                dir = "";
                $.each(value, function (i, val) {
                    dir += val.value;
                });

                if (dir == direccionSeleccionada) {
                    direccionesUsuario.splice(index, 1);
                    window.alert("Borrado");
                } 
            });
        })

        $('.botonModificarD').magnificPopup({
            type: 'inline',
            preloader: false,
            modal: true,
            midClick: true
        });


        $('#buttonCancelarD').click(function (e) {
            $.magnificPopup.close()
        });

        $('#buttonAceptarD').click(function (e) {
            e.preventDefault;
            $('#selectDirecciones')[0].options.length = 0;

            direccionesUsuario.push($('#formuDirecciones').cargaArray());

            //ASí METO LA NUEVA DIRECCIÓN EN EL FORMULARIO DE REGISTRO
            var dir;
            $.each(direccionesUsuario, function (index, value) {
                dir = "";
                $.each(value, function (i, val) {
                    dir += val.value;
                });
                //window.alert("Direccion numero: " + index + "=>" + dir);
                $('#selectDirecciones').append($("<option></option>").val(dir).html(dir));
            });

            

            $.magnificPopup.close();

            //COMPROBACIÓN DE LOS ARRAYS DE DIRECCIONES

            //$.each(direccionesUsuario, function (index, value) {
            //    var dir = "";
            //    $.each(value, function (i, val) {
            //        if (i != 0) {
            //            dir += val.value;
            //        }
            //    });
            //    window.alert("Direccion numero: " + index + "=>" + dir);
            //});

        });

    </script>

    <!-- <div> popUp Telefonos -->
    <div id="formuTelefonos" class="mfp-hide white-popup-block">
        <form id="formuTelefonos">
            <table class="tablaTelefonos">
                <tr>
                    <td colspan="5" style="background-color: #ffad33; height: 30px">
                        <label for="titulo" class="titulo">FICHA DE ALTA DE TELÉFONO</label>
                    </td>
                </tr>
                <tr>
                    <td colspan="5">
                        <label for="campoObligatorio" class="campoObligatorio">*-Campo Obligarotio</label>
                    </td>
                </tr>
                <tr>
                    <td>
                        <label for="textBoxTelefono" class="texto"><span class="campoObligatorio">*</span>-Teléfono:</label>
                        <input id="textBoxTelefono" name="textBoxTelefono" type="text" pattern="[0-9]{9}" />
                    </td>
                </tr>
                <tr>
                    <td>
                        <input id="checkTelefHabitual" name="checkTelefHabitual" type="checkbox" />¿Es teléfono habitual?
                    </td>
                </tr>
                <tr>
                    <td style="text-align:right">
                        <input class="botones" id="buttonAceptarT" name="buttonAceptar" type="button" value="Aceptar" />
                        <input class="botones" id="buttonCancelarT" name="buttonCancelar" type="button" value="Cancelar" />
                    </td>
                </tr>
            </table>
        </form>
    </div>
    <script>
        var telefonosUsuario = [];

        $('.botonAltaT').magnificPopup({
            type: 'inline',
            preloader: false,
            modal: true
        });

        $('#buttonCancelarT').click(function (e) {
            $.magnificPopup.close();
        });

        $('#buttonAceptarT').click(function (e) {
            e.preventDefault;
            var telefono = []

            if ($('#textBoxTelefono').val() != "") {
                telefono.length = 0;
                var checkHabitual = "";
                $("#checkTelefHabitual").is(':checked') == true ? checkHabitual = "S" : checkHabitual = "N";

                telefono.push({
                    telefono: $('#textBoxTelefono').val(),
                    habitual: checkHabitual + ":"
                });

                telefonosUsuario.push(telefono);

                var telef;
                $.each(telefonosUsuario, function (index, value) {
                    telef = "";
                    $.each(value, function (i, val) {
                        telef = val.telefono;
                    });
                    //window.alert("Telefono numero: " + index + "=>" + telef);
                });

                $('#selectTelefonos').append($("<option></option>").val(telef).html(telef));

                $.magnificPopup.close();

            } else {
                window.alert("El campo obligatorio debe ser rellenado");
            }
        });
    </script>



    <script>
        var form = $("#formuRegistro");

        //MÉTODOS AÑADIDOS PARA VALIDACIÓN-------------------------------------------------------------------------------------

        jQuery.validator.addMethod("lettersonly", function (value, element) {
            return this.optional(element) || /^[a-z]+$/i.test(value);
        }, "Solo letras");

        jQuery.validator.addMethod("nifES", function (value, element) {
            "use strict";

            value = value.toUpperCase();

            // Basic format test
            if (!value.match('((^[A-Z]{1}[0-9]{7}[A-Z0-9]{1}$|^[T]{1}[A-Z0-9]{8}$)|^[0-9]{8}[A-Z]{1}$)')) {
                return false;
            }

            // Test NIF
            if (/^[0-9]{8}[A-Z]{1}$/.test(value)) {
                return ("TRWAGMYFPDXBNJZSQVHLCKE".charAt(value.substring(8, 0) % 23) === value.charAt(8));
            }
            // Test specials NIF (starts with K, L or M)
            if (/^[KLM]{1}/.test(value)) {
                return (value[8] === String.fromCharCode(64));
            }

            return false;

        }, "Formato de DNI/Pasaporte incorrecto");

        jQuery.validator.addMethod("nieES", function (value, element) {
            "use strict";

            value = value.toUpperCase();

            // Basic format test
            if (!value.match('((^[A-Z]{1}[0-9]{7}[A-Z0-9]{1}$|^[T]{1}[A-Z0-9]{8}$)|^[0-9]{8}[A-Z]{1}$)')) {
                return false;
            }

            // Test NIE
            //T
            if (/^[T]{1}/.test(value)) {
                return (value[8] === /^[T]{1}[A-Z0-9]{8}$/.test(value));
            }

            //XYZ
            if (/^[XYZ]{1}/.test(value)) {
                return (
                 value[8] === "TRWAGMYFPDXBNJZSQVHLCKE".charAt(
                  value.replace('X', '0')
                   .replace('Y', '1')
                   .replace('Z', '2')
                   .substring(0, 8) % 23
                 )
                );
            }

            return false;

        }, "Formato de NIE incorrecto");

        jQuery.validator.addMethod("cifES", function (value, element) {
            "use strict";

            var sum,
             num = [],
             controlDigit;

            value = value.toUpperCase();

            // Basic format test
            if (!value.match('((^[A-Z]{1}[0-9]{7}[A-Z0-9]{1}$|^[T]{1}[A-Z0-9]{8}$)|^[0-9]{8}[A-Z]{1}$)')) {
                return false;
            }

            for (var i = 0; i < 9; i++) {
                num[i] = parseInt(value.charAt(i), 10);
            }

            // Algorithm for checking CIF codes
            sum = num[2] + num[4] + num[6];
            for (var count = 1; count < 8; count += 2) {
                var tmp = (2 * num[count]).toString(),
                 secondDigit = tmp.charAt(1);

                sum += parseInt(tmp.charAt(0), 10) + (secondDigit === '' ? 0 : parseInt(secondDigit, 10));
            }

            // CIF test
            if (/^[ABCDEFGHJNPQRSUVW]{1}/.test(value)) {
                sum += '';
                controlDigit = 10 - parseInt(sum.charAt(sum.length - 1), 10);
                value += controlDigit;
                return (num[8].toString() === String.fromCharCode(64 + controlDigit) || num[8].toString() === value.charAt(value.length - 1));
            }

            return false;

        }, "Formato de CIF incorrecto");

        //VALIDACIÓN-----------------------------------------------------------------------------------------------------------

        form.validate({
            debug: true,
            success: function (label) {
                label.addClass("valid").text("Ok!")
            },
            onkeyup: false,

            rules: {
                textBoxNombre: {
                    required: true,
                    lettersonly: true,
                    minlength: 3,
                    maxlength: 20,
                },
                textBoxApellido1: {
                    required: false,
                    lettersonly: true,
                    minlength: 3,
                    maxlength: 20,
                },
                textBoxApellido2: {
                    required: false,
                    lettersonly: true,
                    minlength: 3,
                    maxlength: 20,
                },
                selectID: {
                    required: true,
                },

                textBoxIdentificacion: {
                    required: true,
                    nifES: {
                        depends: function (element) {
                            var idSelect = $("#selectID option:selected").text();
                            if (idSelect == "DNI" || idSelect == "Pasaporte") {
                                return true;
                            }
                        }
                    },
                    nieES: {
                        depends: function (element) {
                            var idSelect = $("#selectID option:selected").text();
                            if (idSelect == "Tarjeta Residente") {
                                return true;
                            }
                        }
                    },

                    cifES: {
                        depends: function (element) {
                            var idSelect = $("#selectID option:selected").text();
                            if (idSelect == "CIF") {
                                return true;
                            }
                        }
                    }
                },

                textBoxEmail: {
                    required: true,
                    email: true
                },

                textBoxConfirmaEmail: {
                    required: true,
                    email: true,
                    equalTo: "#textBoxEmail"
                },

                fechaNacimientoInput: {
                    required: true
                },

                textBoxPass: {
                    required: true,
                    minlength: 6
                },

                textBoxConfPass: {
                    required: true,
                    minlength: 6,
                    equalTo: "#textBoxPass"
                },

                selectDirecciones: {
                    required: true,
                },

                selectTelefonos: {
                    required: true,
                },

            },
            messages: {

                textBoxNombre: {
                    required: "Campo obligatorio",
                    minlength: "Minimo 3 caracteres",
                    maxlength: "Máximo 20 caracteres"
                },
                textBoxApellido1: {
                    minlength: "Minimo 3 caracteres",
                    maxlength: "Máximo 20 caracteres"
                },

                textBoxApellido2: {
                    minlength: "Minimo 3 caracteres",
                    maxlength: "Máximo 20 caracteres"
                },
                selectID: {
                    required: "Campo obligatorio"
                },

                textBoxIdentificacion: {
                    required: "Campo obligatorio"
                },

                textBoxEmail: {
                    required: "Campo obligatorio",
                    email: "Formato incorrecto",
                },
                textBoxConfirmaEmail: {
                    required: "Campo obligatorio",
                    email: "Formato incorrecto",
                    equalTo: "Los emails deden ser iguales"
                },

                fechaNacimientoInput: {
                    required: "Campo obligatorio",
                },

                textBoxPass: {
                    required: "Campo obligatorio",
                    minlength: "Minimo 6 caracteres",
                },

                textBoxConfPass: {
                    required: "Campo obligatorio",
                    minlength: "Minimo 6 caracteres",
                    equalTo: "Las contraseñas deden ser iguales"
                },
                selectDirecciones: {
                    required: "Campo obligatorio"
                },

                selectTelefonos: {
                    required: "Campo obligatorio"
                }
            }

        });

        $('#buttonEnviarAlta').click(function (e) {

            if (form.valid() == true) {
                e.preventDefault();
                window.alert("Formulario OK!!");

                var direccionesUsuarioString = "";
                $.each(direccionesUsuario, function (index, value) {
                    $.each(value, function (i, val) {
                        direccionesUsuarioString += val.value;
                    });
                });

                var telefonosUsuarioString = "";
                $.each(telefonosUsuario, function (index, value) {
                    $.each(value, function (i, val) {
                        telefonosUsuarioString += val.telefono + "_" + val.habitual;
                    });
                });

                var usuario = {
                    Nombre: $('#textBoxNombre').val(),
                    Apellido1: $('#textBoxApellido1').val(),
                    Apellido2: $('#textBoxApellido2').val(),
                    TipoID: $("#selectID option:selected").text(),
                    ID: $('#textBoxIdentificacion').val(),
                    Login: $('#textBoxEmail').val(),
                    FechaNacimiento: $('#fechaNacimientoInput').val(),
                    Password: $('#textBoxPass').val(),
                    Direcciones: direccionesUsuarioString,
                    Telefonos: telefonosUsuarioString,
                    FaltaProd: $("#selectFaltaProd option:selected").text()
                }

                var stringNuevoUsuJSON = JSON.stringify(usuario);
                window.alert(stringNuevoUsuJSON);

                $.ajax({
                    type: 'POST',
                    url: '/Servidor.asmx/respuestaNuevoUsuario',
                    data: "{'usuario':" + stringNuevoUsuJSON + "}",
                    contentType: 'application/json; utf-8',
                    dataType: 'json',
                    success: function (respuesta) {
                        var resp = JSON.parse(respuesta.d);
                        window.alert("Respuesta del servidor => " + respuesta.d);
                        //if (resp.codigo == 1) {
                        //    window.location.replace("http://localhost:32426/Compra.aspx");
                        //} else if (resp.codigo == 0) {
                        //    window.location.replace("http://localhost:32426/Vista_Registro.html");
                        //}
                    },
                    error: function (jqXHR, textStatus, errorThrown) {
                        window.alert("Uppss!! Ha ocurrido un error");
                    }
                });

            } else {
                window.alert("Revise los campos!!");
            }
        });

    </script>

</body>
</html>
