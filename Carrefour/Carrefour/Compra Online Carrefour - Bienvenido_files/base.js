var ieold=false;var timerSession;jQuery.uaMatch=function(ua){ua=ua.toLowerCase();var match=/(chrome)[ \/]([\w.]+)/.exec(ua)||/(webkit)[ \/]([\w.]+)/.exec(ua)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(ua)||/(msie) ([\w.]+)/.exec(ua)||ua.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(ua)||[];return{browser:match[1]||"",version:match[2]||"0"};};matched=jQuery.uaMatch(navigator.userAgent);browser={};if(matched.browser=="msie"&&matched.version<9){String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"");};Array.prototype.indexOf=function(obj,start){for(var i=(start||0),j=this.length;i<j;i++){if(this[i]===obj){return i;}}return -1;};window.onkeyup=function(event){event=event||window.event;lastEvent=null;return delete heldKeys[event.keyCode];};}if(matched.browser){browser[matched.browser]=true;browser.version=matched.version;}jQuery(document).ready(function($){if($("#enlaceIdentifica").length!=0&&$("#loginDesdeAction").val()=="true"){if($("#general").data("pagina")!="PreRegistro"&&$("#general").data("pagina")!="Registro"){activarPopUpClick();}if(redireccionarBienvenida()){window.location.href="Home.aspx?redirecClick=true";}}$("#enlaceIdentifica").on("click",function(e){$("#loginDesdeAction").data("hrefRedirect","");});avisocookies();if(isIPad()){window.onpageshow=function(evt){if(evt.persisted){graciasPorEsperarOff();}};}if($("#general").data("pagina")!="Bienvenida"){window.onload=resetTimer;document.onmousemove=resetTimer;document.onkeypress=resetTimer;}function handleIdleTimedOut(){var pagina=$("#header-a").data("pagexpired");pagina=pagina+"?TimeOut=true";mostrarSesionExpirada();}function resetTimer(){clearTimeout(timerSession);var timeoutPeriod=$("#header-a").data("timeexpired");timeoutPeriod=timeoutPeriod+60000;timerSession=setTimeout(handleIdleTimedOut,timeoutPeriod);}eliminarZoom();function isAndroid(){if(navigator.userAgent.match(/Android/i)!=null){return true;}else{return false;}}function isIPad(){if(navigator.userAgent.match(/iPad/i)!=null){return true;}else{return false;}}function isIPhone(){if(navigator.userAgent.match(/iPhone/i)!=null){return true;}else{return false;}}function isIPod(){if(navigator.userAgent.match(/iPod/i)!=null){return true;}else{return false;}}function isIOS(){if(isIPad()||isIPhone()||isIPod()){return true;}else{return false;}}if(browser.msie&&browser.version<9){ieold=true;$("body").addClass("ie");$(".clearfix").each(function(){$(this).append('<div class="clear"></div>');});setHeight("#footer-b-inner",".mod-footer-b");setHeight("#nav-products","li span");}if(browser.msie&&browser.version==9){$("body").addClass("ie9");}if(browser.msie&&browser.version==10){$("body").addClass("ie10");}if(isIOS()){$("body").addClass("ios");}if(isIPad()){$("body").addClass("ipad");}if(isAndroid()){$("body").addClass("android");}$("body").addClass("has-js");anadirClasesListados();$("li.active a").click(function(e){e.preventDefault();});$(".btn-inactive").click(function(e){e.preventDefault();});$(".lnk-up").click(function(e){e.preventDefault();subirPantalla();});$("#general").on("click",".close-layer",function(e){e.preventDefault();$("#loginDesdeAction").data("hrefRedirect","");if($("#general").data("noServimosCodPostal")!==undefined&&$("#general").data("noServimosCodPostal")=="true"){loginInvitadoTienda();}else{if($("#layer-content").data("abreOtroPopup")!==undefined&&$("#layer-content").data("abreOtroPopup")=="true"){$("#layer-content").fadeOut("300",function(){$("#layer-content").remove();stopAnimationLayer();$("#load-layer-small").fadeIn("200");$("#mostrarPopup").data("mostrado","1");$("#general").append('<div id="layer-content"><div class="layer-background"></div><div class="layer-content-inner"><div id="content-inner"></div><a href="#" class="close-layer"><span>Cerrar capa</span></a></div></div>');$("#layer-content").addClass("big");if(matched.browser=="msie"&&matched.version<9){$("#general #layer-content").css("display","none");}var urlLayer="PopupLoginRegistro.aspx?origen=anadir";ajaxLayer(urlLayer);});}else{if($("#layer-content").data("esCambioTienda")!==undefined&&$("#layer-content").data("esCambioTienda")=="true"){cancelarCambioTienda();}if($(".layerTimeOut").length>0){window.location.href=$(".layerTimeOut").attr("href");return;}$(this).closest("#layer-content").fadeOut("300",function(){$("#layer-content").remove();stopAnimationLayer();comprobarMostraragregarListaACesta();});}}});$("#general").on("click",".closeLayer",function(e){e.preventDefault();if($("#general").data("noServimosCodPostal")!==undefined&&$("#general").data("noServimosCodPostal")=="true"){loginInvitadoTienda();}else{if($("#layer-content").data("abreOtroPopup")!==undefined&&$("#layer-content").data("abreOtroPopup")=="true"){$("#layer-content").fadeOut("300",function(){$("#layer-content").remove();stopAnimationLayer();$("#load-layer-small").fadeIn("200");$("#mostrarPopup").data("mostrado","1");$("#general").append('<div id="layer-content"><div class="layer-background"></div><div class="layer-content-inner"><div id="content-inner"></div><a href="#" class="close-layer"><span>Cerrar capa</span></a></div></div>');$("#layer-content").addClass("big");if(matched.browser=="msie"&&matched.version<9){$("#general #layer-content").css("display","none");}urlLayer="PopupLoginRegistro.aspx?origen=anadir";ajaxLayer(urlLayer);});}else{$(this).closest("#layer-content").fadeOut("300",function(){$("#layer-content").remove();stopAnimationLayer();comprobarMostraragregarListaACesta();});}}});$("body").on("click",".classAviso",function(e){e.preventDefault();avisoLegalCuwa();});$("body").on("click",".layer",function(e){e.preventDefault();if($("#layer-content").length){var urlLayer=$(this).attr("href");if($(this).hasClass("popUpRegistro")){$(this).closest("#layer-content").fadeOut("300",function(){$("#layer-content").remove();stopAnimationLayer();$("#load-layer-small").fadeIn("200");$("#general").append('<div id="layer-content"><div class="layer-background"></div><div class="layer-content-inner"><div id="content-inner"></div><a href="#" class="close-layer"><span>Cerrar capa</span></a></div></div>');if(matched.browser=="msie"&&matched.version<9){$("#general #layer-content").css("display","none");}ajaxLayer(urlLayer);});}else{if($(this).hasClass("big")){$("#layer-content").addClass("big");}else{$("#layer-content").removeClass("big");}if(!$("#layer-content .error-msg").hasClass("active")){ajaxLayer02(urlLayer);}}}else{$("#load-layer-small").fadeIn("200");var urlLayer=$(this).attr("href");if($(this).hasClass("big")){$("#general").append('<div id="layer-content" class="big"><div class="layer-background"></div><div class="layer-content-inner"><div id="content-inner"></div><a href="#" class="close-layer"><span>Cerrar capa</span></a></div></div>');}else{if($(this).hasClass("bigCambiar")){$("#general").append('<div id="layer-content" class="big bigCambiar"><div class="layer-background"></div><div class="layer-content-inner"><div id="content-inner"></div><a href="#" class="close-layer"><span>Cerrar capa</span></a></div></div>');}else{$("#general").append('<div id="layer-content"><div class="layer-background"></div><div class="layer-content-inner"><div id="content-inner"></div><a href="#" class="close-layer"><span>Cerrar capa</span></a></div></div>');}}if(matched.browser=="msie"&&matched.version<9){$("#general #layer-content").css("display","none");}ajaxLayer(urlLayer);}});$("#general").on("click","#loginRegistroPopup",function(e){e.preventDefault();$("#loginRegistroPopup").parents("form").find(".error").removeClass("error");var aux="";if($("#loginDesdeAction").data("hrefRedirect")!==undefined){var aux=$("#loginDesdeAction").data("hrefRedirect").replace("?","redirectClick");}$("#origen").val(aux);if(comprobarFormulario($(this))){var recordarUsuario;if($("#opt02").is(":checked")){recordarUsuario=true;}else{recordarUsuario=false;}graciasPorEsperar();$.ajax({url:"LoginRegistro.aspx",data:{user:$("#Email2").val(),pass:$("#password2").val(),opt02:recordarUsuario,origen:$("#origen").val(),eventoUserLogged:$("#eventoUserLogged").val()},type:"POST",success:function(data){graciasPorEsperarOff();if(data.length>20){var protocolo=window.location.protocol;if(protocolo!="https:"){if($("#loginRegPopup input#origen").length>0){if($("#loginRegPopup input#origen").val()=="pagar"){$(location).attr("href","ProcesoPago.aspx");}else{$(location).attr("href","BienvenidaDirecciones.aspx?origen="+$("#loginRegPopup input#origen").val());}}else{$(location).attr("href","BienvenidaDirecciones.aspx?origen="+$("#loginRegPopup input#origen").val());}}else{location.href=$("#loginSuccessURL").val();}}else{var objJson=jQuery.parseJSON(data);if(objJson.error=="2"){$("#loginRegPopup").parents(".module-content").find("ul[data-error='errorLoginPass']").slideDown("fast").addClass("active");$("#loginRegPopup").parents(".module-content").find("ul[data-error='errorLoginPass']").slideDown("fast").css("display","block");if(!$("#password2").hasClass("error")){$("#password2").addClass("error");}}else{if(objJson.error=="1"){$("#loginRegPopup").parents(".module-content").find("ul[data-error='errorLogin']").slideDown("fast").addClass("active");$("#loginRegPopup").parents(".module-content").find("ul[data-error='errorLogin']").slideDown("fast").css("display","block");if(!$("#Email2").hasClass("error")){$("#Email2").addClass("error");}}}}},error:function(data){graciasPorEsperarOff();}});}});$("#general").on("click","#bienvenidaVisitante",function(e){e.preventDefault();if(validacionFormularioBienvenida($(this).parents("form"))){codigoPostal=$("#codigoPostal").val();$.ajax({dataType:"json",url:"ComprobarServicio.aspx",data:{postalCode:codigoPostal},success:function(data){if($("#loginDesdeAction").data("hrefRedirect")!==undefined&&$("#loginDesdeAction").data("hrefRedirect").trim()!=""){$("#origenLoginInvitado").val($("#loginDesdeAction").data("hrefRedirect"));}if(data.error=="1"){$("#loginGuestForm").clone().appendTo("#general").addClass("hide");$("#layer-content").fadeOut("300",function(){$("#layer-content").remove();stopAnimationLayer();errorCodPostal();});}else{$("#bienvenidaVisitanteSubmit").click();}}});}});$("#general").on("click","#botonCrearLista",function(e){crearListaNueva(e);});$("#general").on("click","#botonBorrarLista",function(e){borradoLista(e);});$("#general").on("keyup","#nombreLista",function(e){compruebaNombreLista(e);});$("#general").on("click","#botonConfirmarBorrarLista",function(e){confirmarBorrarLista(e);});$("#general").on("click",".botonCancelarSustituirProductoListaPersonal",function(e){checkCancelarSustituirProductoListaPersonal(e);});$("#general").on("click",".botonSustituirProductoListaPersonal",function(e){checkSustituirProductoListaPersonal(e);});$("#general").on("click",".botonValidarAtencionCliente",function(e){validarAtencionCliente(e);});$("#general").on("click",".botonSustituirTodos",function(e){sustituirTodos(e);});$("#general").on("click","#botonCancelarSustituirProductos",function(e){checkCancelarSustituirProducto(e);});$("#general").on("click","#botonSustituirProducto",function(e){checkSustituirProducto(e);});$("#general").click(function(event){if($("#mensajesErrorAnadir").length>0){$("#mensajesErrorAnadir").remove();}});if(matched.browser=="msie"&&matched.version<9){cerrarCarrito=false;$("#general").click(function(event){if($("#basketContent.show").length&&cerrarCarrito){$("#basket").removeClass("show");$("#basketContent").removeClass("show");$("#basketContent").css("display","none");$("#basketContent").hide();cerrarCarrito=false;}else{if($("#basketContent.show").length){cerrarCarrito=true;}}});$("#general").on("keyup","#emailAtencionCliente",function(e){var key=e.keyCode||e.which;if(key===13){e.preventDefault();$("#hiddenSbmtAtc").click();}});$("#general").on("keyup","input[name='cantidad01']",function(e){var key=e.keyCode||e.which;if(key===13){$(this).parents("form").find(".btn01").click();}});}$(".goToPagGenerica").click(function(e){cargarContenidoCentral(e,$(this).attr("href"),$(this));$("#general").data("pagina","Estatico");$("#general").data("id",$(this).attr("href"));subirPantalla();});$("#header-a ul li .withsubmenu").click(function(){if($(this).hasClass("open")){$(this).removeClass("open").next("ul").hide();}else{$(this).addClass("open").next("ul").show();}});cerrarCapas();initPage();if(matched.browser=="msie"&&matched.version<9){if($("#general").data("pagina")=="BienvenidaDirecciones"){var radio=$(".fancyradio input.radio01");radio.each(function(index){initCheckExplorer($(this));});}if($("#general").data("pagina")=="MiCuentaPost"||$("#general").data("pagina")=="Registro"||$("#general").data("pagina")=="Paso1"||$("#general").data("pagina")=="Paso2"){var checkbox=$(".fancycheckbox .checkbox01");var radio=$(".fancyradio .radio01");checkbox.each(function(index){initCheckExplorer($(this));});radio.each(function(index){initCheckExplorer($(this));});$(".fancyselect .select01").each(function(){initSelectExplorer($(this));});$("#general").on("click",".fancyselect .select01",function(){selectExplorer($(this));});}if($("#general").data("pagina")=="BienvenidaDirecciones"){$("#confirmarDireccion").find(".clearfix").css("clear","both");}}if($("#general").data("pagina")!="MiCuentaPost"&&$("#general").data("pagina")!="Registro"&&$("#general").data("pagina")!="BusquedaExpressResultados"&&$("#general").data("pagina")!="BusquedaResultados"){graciasPorEsperarOff();}if(matched.browser=="msie"){$("input[placeholder]").each(function(){var input=$(this);$(input).val(input.attr("placeholder"));$(input).focus(function(){if(input.val()==input.attr("placeholder")){input.val("");}});$(input).blur(function(){if(input.val()==""||input.val()==input.attr("placeholder")){input.val(input.attr("placeholder"));}});});$("select").change(function(e){$(this).blur();});}if($("#basket").css("top")=="-100px"){$("#basket").css("top","0px");}$(".list06 a").click(function(e){e.preventDefault();var idModule=$(this).attr("href");$("html, body").animate({scrollTop:$(idModule).offset().top-150},600);});if($("#general").data("pagina")=="Home"){var url=window.location.href;var auxRedirect=url.indexOf("redirecClick");if(auxRedirect>0){var subStringRedirect=url.substr(auxRedirect+13);if(subStringRedirect=="true"){$("#enlaceIdentificaOculto").click();}}else{auxRedirect=url.indexOf("origen=horariosEntrega");if(auxRedirect>0){$("#horariosEntrega").click();}}}$("#header").on("click","#promoBienvenida",function(e){e.preventDefault();loadBienvenidaPromocion();});$("#header").on("click",".button-outlet",function(e){e.preventDefault();var id=$(this).find("a").data("enlacecabecera");loadEnlaceCabecera(id);});});function desactivarEnterKeyLayer(){$("#general").on("keypress",".layer",function(e){desactivarEnter(e);});}function graciasPorEsperar(){$("#espera-layer").fadeIn("200");$("#layer-content-espera").css("z-index","500");$("#espera-layer").css("z-index","500");startAnimationGraciasEsperar();$("#layer-content-espera").animate({opacity:1,});if(matched.browser=="webkit"&&(navigator.userAgent.match(/iPad/i)==null)){var v=matched.version.split(".");if(v[0]>=536){$("#espera-layer #espera-image").css("margin-left","97px");}}if(matched.browser=="msie"&&matched.version<9){$("#layer-content-espera-ie8").css("z-index","350");}if(matched.browser=="msie"||(matched.browser=="webkit"&&navigator.platform.indexOf("Win")>-1)){document.getElementById("espera-image").style.marginLeft=95+"px";}}function graciasPorEsperarOff(){$("#layer-content-espera").animate({opacity:0,},300,function(){stopAnimationGraciasEsperar();$("#layer-content-espera").css("z-index","-1000");});$("#espera-layer").fadeOut("200",function(){$("#espera-layer").css("z-index","-1000");});if(matched.browser=="msie"&&matched.version<9){$("#layer-content-espera-ie8").animate({},300,function(){stopAnimationGraciasEsperar();$("#layer-content-espera-ie8").css("z-index","-1000");});}}function cargarContenidoCentral(e,href,element){graciasPorEsperar();if(e!=""){e.preventDefault();}var basket=false;var ayuda=false;var dondeServimos=false;if(href.indexOf("DetalleCarrito.aspx")>=0){basket=true;}else{if(href.indexOf("Ayuda.aspx")>=0){ayuda=true;}else{if(href.indexOf("DondeServimos.aspx")>=0){dondeServimos=true;}}}cambiarMetadatosSEO(null);$("#content-inner").load(href,function(){desactiveHeaderAndFooterElements();if(ayuda){$("#ayudaPie").activa();$("#ayudaCabecera").activa();activaEnlaceRegistroIdentifica();cargarCollapsible();cargarFancyPlay();}else{if(dondeServimos){$("#dondeServimosPie").activa();$("#dondeServimosCabecera").activa();activaEnlaceRegistroIdentifica();}else{if(basket){$("#basket").removeClass("show");$("#basketContent").removeClass("show");$("#basketContent").hide();initMiCompra();$("#header-c-nav ul li.active").removeClass("active");}else{$(element).activa();}}}graciasPorEsperarOff();});}function activaEnlaceRegistroIdentifica(){if($("#enlaceRegistro").text()!=""){$("#enlaceRegistro").wrapInner("<a href='PreRegistro.aspx'></a>");}if($("#enlaceIdentifica").text()!=""){$("#enlaceIdentifica").wrapInner("<a class='layer big' href='PopupLoginRegistro.aspx'></a>");}}function subirPantalla(){$("html, body").animate({scrollTop:0},600);}function desactiveHeaderAndFooterElements(nodoTerminal){$("#header-b-nav ul li a.active").removeClass("active");$("#footer-b-inner ul li a.active").removeClass("active");$("#footer-c-inner ul li a.active").removeClass("active");if(nodoTerminal!=true){$("#header-c-nav ul li.active").removeClass("active");$("#footer-a-inner ul li.active").removeClass("active");}$("#btnSearchExpr").removeClass("active");$("#enlacePedidosAnteriores").removeClass("active");$("#enlaceListas").removeClass("active");$("#enlaceMiCuenta").removeClass("active");}function anadirClasesListados(){$("ul li:last-child").addClass("last");$("table tr").each(function(i,e){$(this).find("th:eq(0)").addClass("first");$(this).find("td:eq(0)").addClass("first");$(this).find("th:last-child").addClass("last");$(this).find("td:last-child").addClass("last");});$("#basketContent table tr").each(function(i,e){$(this).find("th:eq(1)").addClass("second");$(this).find("td:eq(1)").addClass("second");$(this).find("th:eq(2)").addClass("third");$(this).find("td:eq(2)").addClass("third");});$("#basketContent .producto:last-child").addClass("last");}function eliminarZoom(){var obj=document.body;if(obj.addEventListener){obj.addEventListener("DOMMouseScroll",mouseWheel,false);obj.addEventListener("mousewheel",mouseWheel,false);}else{obj.onmousewheel=mouseWheel;}function mouseWheel(e){e=e?e:window.event;if(e.ctrlKey){if(e.preventDefault){e.preventDefault();}else{e.returnValue=false;}return false;}}}function submitFormAjax(e,button,fs){if(e!=null){e.preventDefault();}var form=button.closest("form");var pTextbs="xmlrequest=true&";pTextbs+=form.serialize();pTextbs+="&"+encodeURIComponent(button.attr("name"));pTextbs+="="+encodeURIComponent(button.val());$.post(form.attr("action"),pTextbs).done(fs).fail(function(a1,a2,a3){if(!browser.msie||browser.version>=10){console.log("Error: "+a2+" - "+a3);}});}function cerrarCapas(){$("body").click(function(event){if($("#layer-content").data("abreOtroPopup")!==undefined&&$("#layer-content").data("abreOtroPopup")=="true"){$("#layer-content").fadeOut("300",function(){$("#layer-content").remove();stopAnimationLayer();$("#load-layer-small").fadeIn("200");$("#mostrarPopup").data("mostrado","1");$("#general").append('<div id="layer-content"><div class="layer-background"></div><div class="layer-content-inner"><div id="content-inner"></div><a href="#" class="close-layer"><span>Cerrar capa</span></a></div></div>');$("#layer-content").addClass("big");if(matched.browser=="msie"&&matched.version<9){$("#general #layer-content").addClass("hide");}urlLayer="PopupLoginRegistro.aspx?origen=anadir";ajaxLayer(urlLayer);});}else{if(!$(event.target).closest("#header-a ul li .withsubmenu").length){$("#header-a ul li .withsubmenu").removeClass("open").next("ul").hide();}if(!$(event.target).closest(".mod-help-form.show").length){$(".mod-help-form.show").fadeOut("200",function(){$(".mod-help-form.show").remove();if(matched.browser=="mozilla"&&browser.version<21){$(document).scrollTop($(document).scrollTop()+1);}});}if(!$(event.target).closest("#lista.show").length){$("#lista.show").fadeOut("200",function(){$("#lista").removeClass("show");$(".list-elem.hide").fadeIn("200",function(){$(this).removeClass("hide");});});}if(!$(event.target).closest("#lista02.show").length){$("#lista02.show").fadeOut("200",function(){$("#lista02").removeClass("show");});}if(!$("body").hasClass("ie")){if(!$(event.target).closest("#basketContent.show").length){$("#basketContent.show").fadeOut("fast",function(){$("#basketContent").removeClass("show");$("#basket").removeClass("show");});}}if($(event.target).closest(".layer-background.show").length){if($("#layer-content").data("esCambioTienda")!==undefined&&$("#layer-content").data("esCambioTienda")=="true"){cancelarCambioTienda();}$("#layer-content").fadeOut("300",function(){if($(".layerTimeOut").length>0){window.location.href=$(".layerTimeOut").attr("href");}$("#layer-content").remove();stopAnimationLayer();});}if($("#bienvenidaVisitanteSubmit").length>0&&$(".avisoNoTiendaPopUp").length>0){$(".avisoNoTiendaPopUp").removeClass("avisoNoTiendaPopUp");loginInvitadoTienda();}comprobarMostraragregarListaACesta();if($("#listaTarifasPlanas").length>0&&$("#listaTarifasPlanas").hasClass("show")){ocultarCapaListasTarifaPlana();}}});$("html").bind("touchstart",function(e){if($("#header-a").has(e.target).length===0){$("#header-a ul li .withsubmenu").removeClass("open").next("ul").hide();}if($(".mod-help-form.show").has(e.target).length===0){$(".mod-help-form.show").fadeOut("200",function(){$(".mod-help-form.show").remove();});}if($("#lista.show").has(e.target).length===0){$("#lista.show").fadeOut("200",function(){$("#lista").removeClass("show");$(".list-elem.hide").fadeIn("200",function(){$(this).removeClass("hide");});});}if($("#lista02.show").has(e.target).length===0){$("#lista02.show").fadeOut("200",function(){$("#lista02").removeClass("show");});}if($("#basketContent.show").has(e.target).length===0){$("#basketContent.show").fadeOut("fast",function(){$("#basketContent").removeClass("show");$("#basket").removeClass("show");});}});$(".close-alert").click(function(e){e.preventDefault();$(this).closest(".alert").slideUp("200");});$("#cerrarMensajeCookies").click(function(e){cerrarhtmlcapacontenidoaviso();if($("#basketContent").hasClass("avisoCookiesActivo")){$("#basketContent").removeClass("avisoCookiesActivo");}if($("#lista02").hasClass("avisoCookiesActivoLista")){$("#lista02").removeClass("avisoCookiesActivoLista");}});}function eliminarMensajeCookies(){$.ajax({url:"EliminarMensajeCookies.aspx",type:"POST",data:{},success:function(data){var contentInner=$($.parseHTML(data));var contentProject=$("#content-inner",contentInner).html();$("#layer-content #content-inner").prepend(contentProject);}}).done(function(){});}function ajaxLayer(urlLayer){if(!(matched.browser=="msie"&&matched.version<9)){startAnimationLayer();}$.ajax({url:urlLayer,success:function(data){var contentInner=$(data.trim());var contentProject=$("#content-inner",contentInner).html();$("#layer-content #content-inner").prepend(contentProject);}}).done(function(){if(matched.browser=="msie"&&matched.version<9){$("#general #layer-content").css("display","block");}var posLeft=($(window).width()-$("#layer-content .layer-content-inner").outerWidth())/2;var posTop=($(window).height()-$("#layer-content .layer-content-inner").outerHeight())/2;if(posTop<20){posTop=40;var maxHeight=$(window).height()-130;$("#layer-content #content-inner").css("max-height",maxHeight);}$("#layer-content .layer-content-inner").css("left",posLeft).css("top",posTop);$("#layer-content").animate({opacity:1,},300,function(){$(".layer-background").addClass("show");$("#load-layer-small").fadeIn("200",function(){$("#load-layer-small").fadeOut("200");stopAnimationLayer();});});if($("#cambiarFranjaTabla").length>0){initCambiarFranjaPopup();}controlScrollAjaxLayer($(".layer-content-inner #content-inner"));});return false;}function ajaxLayer02(urlLayer){$.ajax({url:urlLayer,success:function(data){var contentInner=$(data.trim());var contentProject=$("#content-inner",contentInner).html();$("#layer-content #content-inner").prepend('<div class="hide">'+contentProject+"</div>");$(".layer-content-inner #content-inner > ").fadeOut("slow",function(){$("#layer-content #content-inner > #page-title").remove();$("#layer-content #content-inner > .row").remove();});$(".layer-content-inner .hide ").fadeIn("slow");}}).done(function(){var posLeft=($(window).width()-$("#layer-content .layer-content-inner").outerWidth())/2;var posTop=($(window).height()-$("#layer-content .layer-content-inner").outerHeight())/2;if(posTop<20){posTop=40;var maxHeight=$(window).height()-130;$("#layer-content").css("max-height",maxHeight);}$("#layer-content .layer-content-inner").animate({left:posLeft,top:posTop},300);if($("#cambiarFranjaTabla").length>0){initCambiarFranjaPopup();}controlScrollAjaxLayer(layer);});return false;}function initCambiarFranjaPopup(){posicionarIndisponibilidad();$("#botonCambiarFranjaPopup").on("click",function(e){e.preventDefault();var radioButtons=$(".table06 .radio01");var idFranja="";for(var i=0;i<radioButtons.length;i++){if(radioButtons[i].checked){idFranja=radioButtons[i].value;break;}}if(""!=idFranja){$("#botonCambiarFranjaPopupCerrar").click();graciasPorEsperar();var idPedido=$(this).data("pedido");$.ajax({url:"GetCambiarFranja.aspx",data:{idPedido:idPedido,idFranja:idFranja},dataType:"json",success:function(data){if(data.respuesta=="OK"){graciasPorEsperarOff();var pagina=$("#general").data("pagina");switch(pagina){case"PedidosAnteriores":loadPedidosAnteriores();break;case"PrevioMiCuenta":loadPrevioMiCuenta(e);break;case"":break;}popupAlert("label.aviso","label.modificarPedido.correctoCambioFecha");}else{if(data.respuesta=="timeOut"){popupAlert("label.aviso","label.modificarPedido.timeOut");graciasPorEsperarOff();}else{popupAlert("label.aviso","label.modificarPedido.error");graciasPorEsperarOff();}}},error:function(data){popupAlert("label.aviso","label.modificarPedido.error");graciasPorEsperarOff();}});}else{$("#franjaNoSelected").removeClass("hide");$("#franjaNoSelected").addClass("show");}});}function controlScrollAjaxLayer(layer){var parentLayer=layer.parent();var alturaEnlace=parentLayer.find("a.close-layer").get(0).scrollHeight;if(alturaEnlace===undefined){alturaEnlace=0;}if((parentLayer.get(0).scrollHeight-alturaEnlace)<layer.get(0).scrollHeight){layer.css("z-index","10");$(".close-layer").css("top","-20px");$(".close-layer").css("right","-20px");}}function mostrarTogle(){$(".toggler-elem").click(function(e){if(!$(this).hasClass("active")){var targetElem=$(this).data("target");if($(this).closest(".toggled-elem").length){var dataName=$(this).closest(".toggled-elem").attr("id");if(!$("[data-target='"+dataName+"']").hasClass("active")){$(".toggler-elem.active").removeClass("active");}$(this).closest(".toggled-elem").find(".toggler-elem.active").removeClass("active");}else{$(".toggler-elem.active").removeClass("active");}$(this).addClass("active");var height01;var height02=$(this).offset().top;var height03;if($(".toggled-elem-active").length){height03=$(".toggled-elem-active").offset().top;if(height02>height03){height01=height02-height03;}else{height01=0;}}else{height01=0;height02=$("#"+targetElem).offset().top+250;}height02=height02-height01;if(!$("#header").hasClass("simple")){height02=height02-250;}$(".toggled-elem-active .formrow input").addClass("disabled");$(".toggled-elem-active .formrow select").addClass("disabled");$(".toggled-elem-active .formrow button").addClass("disabled");$("#"+targetElem).parent().find(".toggled-elem-active").slideUp(600);$(".toggled-elem-active").removeClass("toggled-elem-active");$("#"+targetElem).addClass("toggled-elem-active");$(".toggled-elem-active .formrow input.disabled").removeClass("disabled");$(".toggled-elem-active .formrow select.disabled").removeClass("disabled");$(".toggled-elem-active .formrow button.disabled").removeClass("disabled");var elem=$(this);$("#"+targetElem).slideToggle(600);if($(this).hasClass("toggler-elem-hide")){$(this).slideUp("slow").addClass("hide-elem");}else{$(".toggler-elem-hide.hide-elem").slideDown("slow").removeClass("hide-elem");}if($(this).hasClass("radio01")){var nameInput=$(this).attr("name");$(this).addClass("ee").addClass("active");$("input[name="+nameInput+"]:not(.ee)").removeClass("active");var targetElem02=$("input[name="+nameInput+"]:not(.ee)").data("target");$("#"+targetElem02).slideUp(600,function(){$("html, body").animate({scrollTop:elem.offset().top-250},600);$("#"+targetElem02+" .toggler-elem.active").removeClass("active");});$(this).removeClass("ee");$(".direccion a.active").removeClass("active");}else{$("html, body").animate({scrollTop:height02},600);return false;}}else{e.preventDefault();}});$(".toggle-close").click(function(e){e.preventDefault();var pos01=$(this).closest(".toggled-elem").offset().top-250;$(this).closest(".toggled-elem").slideToggle(600);var idToggle=$(this).closest(".toggled-elem").attr("id");$("a[data-target="+idToggle+"]").removeClass("active");$(".hide-elem").slideDown("slow").removeClass("hide-elem");$("html, body").animate({scrollTop:pos01},600);});}function popupAlert(title,msg,mensajeTraducido){$("#load-layer-small").fadeIn("200");$("#general").append('<div id="layer-content" ><div class="layer-background"></div><div class="layer-content-inner"><div id="content-inner"></div><a href="#" class="close-layer"><span>Cerrar capa</span></a></div></div>');if(matched.browser=="msie"&&matched.version<9){$("#general #layer-content").css("display","none");}var data;if(mensajeTraducido!==undefined&&mensajeTraducido!=null){data={title:title,msg:msg,mensajeTraducido:mensajeTraducido};}else{data={title:title,msg:msg};}$.ajax({url:"AlertPopup.aspx",type:"POST",data:data,success:function(data){var contentInner=$($.parseHTML(data));var contentProject=$("#content-inner",contentInner).html();$("#layer-content #content-inner").prepend(contentProject);}}).done(function(){var mensajeMostrado=$("#mostrarPopup").data("mostrado");if(mensajeMostrado=="0"){$("#layer-content").data("abreOtroPopup","true");}var posLeft=($(window).width()-$("#layer-content .layer-content-inner").outerWidth())/2;var posTop=($(window).height()-$("#layer-content .layer-content-inner").outerHeight())/2;if(posTop<20){posTop=40;var maxHeight=$(window).height()-130;$("#layer-content #content-inner").css("max-height",maxHeight);}$("#layer-content .layer-content-inner").css("left",posLeft).css("top",posTop);$("#layer-content").animate({opacity:1,},300,function(){if(matched.browser=="msie"&&matched.version<9){$("#general #layer-content").css("display","block");var posLeft=($(window).width()-$("#layer-content .layer-content-inner").outerWidth())/2;var posTop=($(window).height()-$("#layer-content .layer-content-inner").outerHeight())/2;if(posTop<20){posTop=40;var maxHeight=$(window).height()-130;$("#layer-content #content-inner").css("max-height",maxHeight);}$("#layer-content .layer-content-inner").css("left",posLeft).css("top",posTop);}$(".layer-background").addClass("show");$("#load-layer-small").fadeIn("200",function(){$("#load-layer-small").fadeOut("200");stopAnimationLayer();});});});if(!(matched.browser=="msie"&&matched.version<9)){startAnimationLayer();}}function confirmacion(title,msg,nombre,callbackOk,callbackNo){$("#load-layer-small").fadeIn("200");$("#general").append('<div id="layer-content" ><div class="layer-background"></div><div class="layer-content-inner"><div id="content-inner"></div><a href="#" class="close-layer"><span>Cerrar capa</span></a></div></div>');if(matched.browser=="msie"&&matched.version<9){$("#general #layer-content").css("display","none");}$.ajax({url:"ConfirmPopup.aspx",type:"POST",data:{title:title,msg:msg},success:function(data){var contentInner=$($.parseHTML(data));var contentProject=$("#content-inner",contentInner).html();$("#layer-content #content-inner").prepend(contentProject);if(nombre!=null){$("#nombreLista").append(nombre);}}}).done(function(){var posLeft=($(window).width()-$("#layer-content .layer-content-inner").outerWidth())/2;var posTop=($(window).height()-$("#layer-content .layer-content-inner").outerHeight())/2;if(posTop<20){posTop=40;var maxHeight=$(window).height()-130;$("#layer-content #content-inner").css("max-height",maxHeight);}$("#layer-content").on("click","#botonOkVentanaConfirmacion",function(e){e.preventDefault();if(callbackOk!=undefined){callbackOk();}$(".close-alert").click();});$("#layer-content").on("click","#botonNoVentanaConfirmacion",function(e){e.preventDefault();if(callbackNo!=undefined){callbackNo();}});$("#layer-content .layer-content-inner").css("left",posLeft).css("top",posTop);$("#layer-content").animate({opacity:1,},300,function(){if(matched.browser=="msie"&&matched.version<9){$("#general #layer-content").css("display","block");var posLeft=($(window).width()-$("#layer-content .layer-content-inner").outerWidth())/2;var posTop=($(window).height()-$("#layer-content .layer-content-inner").outerHeight())/2;if(posTop<20){posTop=40;var maxHeight=$(window).height()-130;$("#layer-content #content-inner").css("max-height",maxHeight);}$("#layer-content .layer-content-inner").css("left",posLeft).css("top",posTop);}$(".layer-background").addClass("show");$("#load-layer-small").fadeIn("200",function(){$("#load-layer-small").fadeOut("200");stopAnimationLayer();});});});if(!(matched.browser=="msie"&&matched.version<9)){startAnimationLayer();}}var tiempoTransicion=5000;var transitionsTimer;var carruselAltura=500;var carruselAlturaTimer;function carrusel(){if($(".slider").length){$(".slider").data("altura","0");if(browser.msie&&browser.version<=10){$(".slider .slide li").show();}calcularAlturaCarrusel();if(browser.msie&&browser.version<=10){$(".slider .slide li").hide();$(".slider .slide li.active").show();}clearTimeout(transitionsTimer);transitionsTimer=setTimeout("carruselTransitions()",tiempoTransicion);}$(".slider .slider-control li").click(function(e){if(!$(this).hasClass("active")){clearInterval(transitionsTimer);var posSlide=$(this).index();if(browser.msie&&browser.version<=10){$(".slider .slide li").fadeOut();}$(this).closest(".slider").find(".slide .active").removeClass("active");$(this).closest(".slider").find(".slide li:eq("+posSlide+")").addClass("active");$(this).closest("ul").find(".active").removeClass("active");$(this).addClass("active");clearTimeout(transitionsTimer);transitionsTimer=setTimeout("carruselTransitions()",tiempoTransicion);if(browser.msie&&browser.version<=10){$(".slider .slide li.active").fadeIn();}}});}function calcularAlturaCarrusel(){var maxHeight=0;var numLi=$(".slider").find("ul.slide li").length;if($(".slider").length){$(".slider").each(function(i,e){if(numLi>1){for(var x=0;x<numLi;x++){var maxHeight02=$(this).find("ul li:eq("+x+") img").height();maxHeight=Math.max(maxHeight,maxHeight02);var y=x+1;if($(this).find(".slider-control li").length<numLi){$(this).find(".slider-control").append("<li>"+y+"</li>");}}}else{maxHeight=$(this).find("ul li:eq(0) img").height();}if(maxHeight==0||maxHeight==16){var num=$(".slider").data("altura");if(num<=9){num++;$(".slider").data("altura",num);carruselAlturaTimer=setTimeout("calcularAlturaCarrusel()",carruselAltura);return;}else{$(".slider").parent().remove();return;}}else{if(carruselAlturaTimer!==undefined){clearTimeout(carruselAlturaTimer);}}$(".slider").removeData("altura");$(this).height(maxHeight);$(this).find("ul li:eq(0)").addClass("active");$(this).find("ul.slider-control li:eq(0)").addClass("active");numLi=numLi-1;$(this).find("ul.slider-control li:eq("+numLi+")").addClass("last");});}}function carruselTransitions(){var e=$(".slider .slider-control li.active");var posSlide=$(".slider .slider-control li.active").index();posSlide=posSlide+1;if(browser.msie&&browser.version<=10){$(".slider .slide li").fadeOut();}if(e.hasClass("last")){$(".slider .slider-control li.active").removeClass("active");$(".slider .slider-control li:eq(0)").addClass("active");$(".slider .slide li.active").removeClass("active");$(".slider .slide li:eq(0)").addClass("active");}else{$(".slider .slider-control li.active").removeClass("active");$(".slider .slider-control li:eq("+posSlide+")").addClass("active");$(".slider .slide li.active").removeClass("active");$(".slider .slide li:eq("+posSlide+")").addClass("active");}if(browser.msie&&browser.version<=10){$(".slider .slide li.active").fadeIn();}transitionsTimer=setTimeout("carruselTransitions()",tiempoTransicion);}var cSpeed=5;var cWidth=20;var cHeight=20;var cTotalFrames=18;var cFrameWidth=20;var cImageSrc="_gfx/sprite-loading.png";var cImageTimeout=false;var cIndex=0;var cXpos=0;var cPreloaderTimeout=false;var SECONDS_BETWEEN_FRAMES=0;function startAnimationLayer(){cPreloaderTimeout=setTimeout("continueAnimationLayer()",5);}function startAnimationGraciasEsperar(){cPreloaderTimeout=setTimeout("continueAnimationGraciasEsperar()",5);}function continueAnimationLayer(){cXpos+=cFrameWidth;cIndex+=1;if(cIndex>=cTotalFrames){cXpos=0;cIndex=0;}if(document.getElementById("loaderImageLayer")){document.getElementById("loaderImageLayer").style.backgroundPosition=(-cXpos)+"px 0";}cPreloaderTimeout=setTimeout("continueAnimationLayer()",20);}function continueAnimationGraciasEsperar(){cXpos+=cFrameWidth;cIndex+=1;if(cIndex>=cTotalFrames){cXpos=0;cIndex=0;}if(document.getElementById("espera-image")){document.getElementById("espera-image").style.backgroundPosition=(-cXpos)+"px 0";}if(matched.browser=="msie"||(matched.browser=="webkit"&&navigator.platform.indexOf("Win")>-1)){document.getElementById("espera-image").style.marginLeft=95+"px";}cPreloaderTimeout=setTimeout("continueAnimationGraciasEsperar()",20);}function stopAnimationLayer(){clearTimeout(cPreloaderTimeout);cPreloaderTimeout=false;}function stopAnimationGraciasEsperar(){clearTimeout(cPreloaderTimeout);cPreloaderTimeout=false;}function startAnimation(){FPS=Math.round(100/cSpeed);SECONDS_BETWEEN_FRAMES=1/FPS;cPreloaderTimeout=setTimeout("continueAnimation()",SECONDS_BETWEEN_FRAMES/1000);}function continueAnimation(){cXpos+=cFrameWidth;cIndex+=1;if(cIndex>=cTotalFrames){cXpos=0;cIndex=0;}if(document.getElementById("loaderImage")){document.getElementById("loaderImage").style.backgroundPosition=(-cXpos)+"px 0";}cPreloaderTimeout=setTimeout("continueAnimation()",SECONDS_BETWEEN_FRAMES*1000);}function stopAnimation(){clearTimeout(cPreloaderTimeout);cPreloaderTimeout=false;}function imageLoader(s,fun){clearTimeout(cImageTimeout);cImageTimeout=0;genImage=new Image();genImage.onload=function(){cImageTimeout=setTimeout(fun,0);};genImage.onerror=new Function("alert('Could not load the image')");genImage.src=s;}document.onreadystatechange=function(){if(document.readyState==="complete"){setHeight("#footer-b-inner",".mod-footer-b");setHeight("#nav-products","li span");$("ul.products").each(function(){if(!$(this).hasClass("listado")&&!$(this).hasClass("listado02")){setHeight($(this),"li .info-product");setHeight($(this),"li .price-product");setHeight($(this),"li .buttons");}});setHeight("ul.tabs","li a");$("body").addClass("load");setHeight("#basketContent tr","td");$("#basketContent").addClass("active");}};function setHeight(container_slct,target_slct){var containers=[];$(container_slct).each(function(i,e){if($.inArray($(this).parent(),containers)==-1){containers.push($(this).parent());}});for(var x=0;x<containers.length;x++){var maxHeight=0;$(target_slct,containers[x]).each(function(i,e){maxHeight=Math.max(maxHeight,$(e).height());});$(target_slct,containers[x]).height(maxHeight);}}$.fn.appendLoad=function(url,params,callback){var selector,off=url.indexOf(" "),content=$(this);if(off>=0){selector=url.slice(off,url.length);url=url.slice(0,off);}var fun=callback;};$.fn.activa=function(){var content=$(this);content.siblings().removeClass("active");content.addClass("active");};$.fn.reload=function(params,callback){if(params===undefined){$(this).load($(this).data("reload"));}else{if(callback===undefined){$(this).load($(this).data("reload"),params);}else{$(this).load($(this).data("reload"),params,callback);}}};function ajaxSubmit(e,button,fs){e.preventDefault();var form=button.parents("form");var pTextbs="xmlrequest=true&";pTextbs+=form.serialize();pTextbs+="&"+encodeURIComponent(button.attr("name"));pTextbs+="="+encodeURIComponent(button.val());$.post(form.attr("action"),pTextbs).done(fs).fail(function(a1,a2,a3){if(!browser.msie||browser.version>=10){console.log("Error: "+a2+" - "+a3);}});}function validarAtencionCliente(event){event.preventDefault();var email=$("#emailAtencionCliente").val();var mensaje=$("textarea[name='mensaje']").val();var error=false;if(email==null||email==""){$("#error-msg-email").show();if(!$("#emailAtencionCliente").hasClass("error")){$("#emailAtencionCliente").addClass("error");}error=true;}else{expr=/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;if(!expr.test(email)){$("#error-msg-email").show();if(!$("#emailAtencionCliente").hasClass("error")){$("#emailAtencionCliente").addClass("error");}error=true;}else{$("#error-msg-email").hide();if($("#emailAtencionCliente").hasClass("error")){$("#emailAtencionCliente").removeClass("error");}}}if(mensaje==null||mensaje==""){$("#error-msg-mensaje").show();if(!$("#mensajeAtencionCliente").hasClass("error")){$("#mensajeAtencionCliente").addClass("error");}error=true;}else{$("#error-msg-mensaje").hide();if($("#mensajeAtencionCliente").hasClass("error")){$("#mensajeAtencionCliente").removeClass("error");}}if(error){event.preventDefault();controlScrollAjaxLayer($(".layer-content-inner #content-inner"));}else{event.preventDefault();submitFormAjax(event,$("#hiddenSbmtAtc").parent().find(".btn01"),function(data){$("#layer-content #content-inner").empty();var contentInner=$(data.trim());var contentProject=$("#content-inner",contentInner).html();$("#layer-content #content-inner").prepend(contentProject);});}}function submitOnPopup(btn,hdn){btn.click(function(e){submitFormAjax(e,hdn,function(data){$("#layer-content #content-inner").empty();var contentInner=$(data.trim());var contentProject=$("#content-inner",contentInner).html();$("#layer-content #content-inner").prepend(contentProject);});});}function initForgotPassword(){this.submitOnPopup($("#hiddenSbmtForgotPwd"),$("#hiddenSbmtForgotPwd").parent().find(".btn01"));}var numDirecciones=1;function mostrarRespuesta(transport){$("#confirmarDireccion").replaceWith(transport);}function toggle(){if($("#driverSelect").val()!="0"){var optionSelected=$("#driverSelect").find("option[selected]");$("#driverSelect").parents(".fancyselect").fadeOut("fast",mostrarDireccionHiper(optionSelected));}$("#modificarDireccionDrive").click(function(e){e.preventDefault();if($("#general").data("pagina")=="Paso1"){var datos=$("#driverSelect").val();$("#driverSelect").data("anterior",datos);}$("#direccionHiperSeleccionada").fadeOut("fast",mostrarComboHiper);});$("#driverSelect").on("change",function(e){var optionSelected=$("option:selected",this);$("#driverSelect").parents(".fancyselect").fadeOut("fast",mostrarDireccionHiper(optionSelected));});$(".toggler-elem").click(function(e){if(!$(this).hasClass("active")){var targetElem=$(this).data("target");if($(this).closest(".toggled-elem").length){var dataName=$(this).closest(".toggled-elem").attr("id");if(!$("[data-target='"+dataName+"']").hasClass("active")){$(".toggler-elem.active").removeClass("active");}$(this).closest(".toggled-elem").find(".toggler-elem.active").removeClass("active");}else{$(".toggler-elem.active").removeClass("active");}$(this).addClass("active");var height01;var height02=$(this).offset().top;var height03;if($(".toggled-elem-active").length){height03=$(".toggled-elem-active").offset().top;if(height02>height03){height01=height02-height03;}else{height01=0;}}else{height01=0;if($("#"+targetElem).offset()!==undefined){height02=$("#"+targetElem).offset().top+250;}else{height02=0;}}height02=height02-height01;if(!$("#header").hasClass("simple")){height02=height02-250;}$(".toggled-elem-active .formrow input").addClass("disabled");$(".toggled-elem-active .formrow select").addClass("disabled");$(".toggled-elem-active .formrow button").addClass("disabled");$("#"+targetElem).parent().find(".toggled-elem-active").slideUp(600);$(".toggled-elem-active").removeClass("toggled-elem-active");$("#"+targetElem).addClass("toggled-elem-active");$(".toggled-elem-active .formrow input.disabled").removeClass("disabled");$(".toggled-elem-active .formrow select.disabled").removeClass("disabled");$(".toggled-elem-active .formrow button.disabled").removeClass("disabled");var elem=$(this);$("#"+targetElem).slideToggle(600);if($(this).hasClass("toggler-elem-hide")){$(this).slideUp("slow").addClass("hide-elem");}else{$(".toggler-elem-hide.hide-elem").slideDown("slow").removeClass("hide-elem");}if($(this).hasClass("radio01")){var nameInput=$(this).attr("name");$(this).addClass("ee").addClass("active");$("input[name="+nameInput+"]:not(.ee)").removeClass("active");var targetElem02=$("input[name="+nameInput+"]:not(.ee)").data("target");$("#"+targetElem02).slideUp(600,function(){});$(this).removeClass("ee");$(".direccion a.active").removeClass("active");}else{return false;}}else{e.preventDefault();}});cancelToggleEnlace();if($("input[type=radio].checked").length){$("input[type=radio].checked").trigger("click");$("input[type=radio].checked").addClass("active");if($("input[type=radio].checked").hasClass("toggler-elem")){var targetElem=$("input[type=radio].checked").data("target");$("#"+targetElem).show();}}$(".form .ico-help").hover(function(e){if(!$(this).closest(".col2").find(".mod-help-form.show").length){helpForm($(this));}});$("input").focusin(function(){if($(this).parent().find(".ico-help").length){helpForm($(this).parent().find(".ico-help"));$("html, body").animate({scrollTop:$(this).offset().top-250},600);}else{$(".mod-help-form.show").fadeOut("200",function(){$(".mod-help-form.show").remove();});}});}function cancelToggleEnlace(){$("#toggleF").on("click",".toggle-close",cancelToggle);$("#confirmarDireccion").on("click",".toggle-close",cancelToggle);}function cancelToggle(e){e.preventDefault();var pos01=$(this).closest(".toggled-elem").offset().top-250;$(this).closest(".toggled-elem").slideToggle(600);var idToggle=$(this).closest(".toggled-elem").attr("id");$("a[data-target="+idToggle+"]").removeClass("active");$(".hide-elem").slideDown("slow").removeClass("hide-elem");$("html, body").animate({scrollTop:pos01},600);if($(this).parents("#toggleF").length>0){$("#toggleF").addClass("hide");}}function mostrarDireccionHiper(optionSelected){$("#direccionHiperSeleccionada").find("p.calle").text(optionSelected.text().trim());$("#direccionHiperSeleccionada").fadeIn("fast");}function mostrarComboHiper(){$("#driverSelect").val("0");$("#driverSelect").parents(".fancyselect").fadeIn("fast");if($("#general").data("pagina")=="BienvenidaDirecciones"){validarBienvenidaDirecciones();}else{if($("#general").data("pagina")=="Paso1"){}else{buttonStateCap(false);}}}function helpForm(elem){if(!$(this).closest(".col2").find(".mod-help-form").length){$(".mod-help-form.show").fadeOut("200",function(){$(".mod-help-form.show").remove();});var textHelp=elem.data("target");if(textHelp!=undefined){elem.closest(".col2").append("<div class='mod-help-form'><p>"+textHelp+"</p></div>");var tamano01=elem.closest(".formrow").width()-elem.closest(".formrow").find(".col1").width()-10-elem.position().left;if(tamano01<=250){$(".mod-help-form").addClass("pos02");}$(".mod-help-form").fadeIn("300",function(){$(".mod-help-form").addClass("show");});}}}function eliminarDireccion(){$("#contentSection").on("click",".eliminarDireccion",function(e){e.preventDefault();graciasPorEsperar();numDirecciones=1;$("#secondAddress").val(false);$(".eliminarDireccion").parents(".direccion").addClass("hide");$("#nuevaDireccion").removeClass("hide");$("#toggle02 select").val(0);$("#toggle02 input").val("");$("#toggle02 textarea").val("");var direccion1=$("#pD1").text();var direccion2="";$("#modoEntrega").reload({direccion1:direccion1,direccion2:direccion2},cargarFuncionalidadModoEntrega);});}function initDirecciones(){eliminarDireccion();$(".checked").attr("checked","checked");direccionFacturacion={tipo:"billingAddress",routeType:$("#txttipovia").val(),address1:$("#txtnombrevia").val(),address2:$("#txtnumero").val(),city:$("#txtlocalidad").val(),postalCode:$("#txtcodpostal").val(),province:$("#txtprovincia").val(),urbanizacion:$("#txturbanizacion").val(),bloque:$("#txtbloque").val(),escalera:$("#txtescalera").val(),piso:$("#txtpiso").val(),puerta:$("#txtpuerta").val(),telefono:$("#txttelefono").val(),telefono2:$("#txtotrotelefono").val(),informacion:$("#txtinformacion").val(),normalizada:0,coordYBill:"",coordXBill:"",seccionCensal:"",normalizadaAux:false,creada:false};if(typeof direccionEntrega!=="undefined"){numDirecciones=2;direccionEntrega={tipo:"shippingAddress",routeType:$("#txttipovia2").val(),address1:$("#txtnombrevia2").val(),address2:$("#txtnumero2").val(),city:$("#txtlocalidad2").val(),postalCode:$("#txtcodpostal2").val(),province:$("#txtprovincia2").val(),urbanizacion:$("#txturbanizacion2").val(),bloque:$("#txtbloque2").val(),escalera:$("#txtescalera2").val(),piso:$("#txtpiso2").val(),puerta:$("#txtpuerta2").val(),telefono:$("#txttelefono2").val(),telefono2:$("#txtotrotelefono2").val(),informacion:$("#txtinformacion2").val(),normalizada:0,coordYBill:"",coordXBill:"",seccionCensal:"",normalizadaAux:false,creada:false};}$(".formrow .col2 .col2b:last-child").addClass("last");}function desactivarIntroInputDirecciones(){$($("#bill").parents(".form")[0]).find("input").bind("keypress",function(e){var key=e.keyCode||e.which;if(key===13){e.preventDefault();validateAddress("bill");}});$($("#ship").parents(".form")[0]).find("input").bind("keypress",function(e){var key=e.keyCode||e.which;if(key===13){e.preventDefault();validateAddress("ship");}});}function desactivarEnter(e){var key=e.keyCode||e.which;if(key===13){e.preventDefault();}}function validateAddress(addressId){if(buttonStateDireccion(true,addressId)){return;}direccionCambio={};if(typeof direccionEntrega==="undefined"){direccionEntrega={normalizadaAux:false};}if(typeof direccionFacturacion==="undefined"){direccionFacturacion={normalizadaAux:false};}if(addressId=="bill"){direccionFacturacion={tipo:"billingAddress",routeType:$("#txttipovia").val(),address1:$("#txtnombrevia").val(),address2:$("#txtnumero").val(),city:$("#txtlocalidad").val(),postalCode:$("#txtcodpostal").val(),province:$("#txtprovincia").val(),urbanizacion:$("#txturbanizacion").val(),bloque:$("#txtbloque").val(),escalera:$("#txtescalera").val(),piso:$("#txtpiso").val(),puerta:$("#txtpuerta").val(),telefono:$("#txttelefono").val(),telefono2:$("#txtotrotelefono").val(),informacion:$("#txtinformacion").val(),normalizada:0,coordYBill:"",coordXBill:"",seccionCensal:"",normalizadaAux:false,creada:false};if(typeof direccionFacturacion!=="undefined"){direccionCambio=$.extend({},direccionFacturacion);}validateAddressEnvio(direccionFacturacion);}else{if(addressId=="ship"){numDirecciones=2;direccionEntrega={tipo:"shippingAddress",routeType:$("#txttipovia2").val(),address1:$("#txtnombrevia2").val(),address2:$("#txtnumero2").val(),city:$("#txtlocalidad2").val(),postalCode:$("#txtcodpostal2").val(),province:$("#txtprovincia2").val(),urbanizacion:$("#txturbanizacion2").val(),bloque:$("#txtbloque2").val(),escalera:$("#txtescalera2").val(),piso:$("#txtpiso2").val(),puerta:$("#txtpuerta2").val(),telefono:$("#txttelefono2").val(),telefono2:$("#txtotrotelefono2").val(),informacion:$("#txtinformacion2").val(),normalizada:0,coordYBill:"",coordXBill:"",seccionCensal:"",normalizadaAux:false,creada:false};if(typeof direccionEntrega!=="undefined"){direccionCambio=$.extend({},direccionEntrega);}validateAddressEnvio(direccionEntrega);}else{if(addressId=="fact"){comprobarDatosFacturacion();}}}}function validateAddressEnvio(modificado){var pagina=$("#general").data("pagina");graciasPorEsperar();var params=obtenerParametrosRegistro(modificado,false);auxRegistroHtml=$("#confirmarDireccion").clone();$("#confirmarDireccion").replaceWith("<div id='confirmarDireccion'></div>");$.ajax({url:"NormalizarDireccion.aspx",data:params,type:"POST",success:mostrarRespuesta}).done(function(){repintarParametrosRegistro();if($("#direccionValidada").val()=="true"){modificado.coordXBill=$("#coordXAux").val();modificado.coordYBill=$("#coordYAux").val();modificado.normalizada=$("#indiceFiabilidadAux").val();modificado.seccionCensal=$("#seccionCensalAux").val();modificado.normalizadaAux=true;modificado.routeType=$("#odRouteType").val();modificado.address1=$("#odAddress1").val();modificado.address2=$("#odAddress2").val();modificado.postalCode=$("#odPostalCode").val();modificado.province=$("#odProvince").val();modificado.city=$("#odCity").val();var direccion1=$("#pD1").text();var direccion2=$("#pD2").text();validarFormularioDireccion();if($("#general").data("pagina")=="BienvenidaDirecciones"||$("#general").data("pagina")=="Paso1"){var codPostal;var tipoEntrega;if(modificado.tipo=="billingAddress"){$("#secondAddress").remove();actualizarDireccionBill();codPostal=direccionFacturacion.postalCode;tipoEntrega="A_DOMICILIO";}else{$("#secondAddress").val(true);$("#tipoDireccionModificar").val("shipingAddress");actualizarDireccionShip();codPostal=direccionEntrega.postalCode;tipoEntrega="OTRO_DOMICILIO";}if($("#general").data("pagina")=="Paso1"){$("#general").data("cambioDireccion","true");var idPedido=$("#orderId").val();campoContactInfo=$("#campoContactInfo").val();cambioTiendaAjax({orderId:idPedido,tipoEntrega:tipoEntrega,crearNuevaDireccion:codPostal,originContextPath:"/supermercado"});}else{$("#submitfrmDireccionBill").click();}}else{$("#modoEntrega").reload({direccion1:direccion1,direccion2:direccion2},cargarFuncionalidadModoEntrega);}}else{$("#general").data("cambioDireccion","true");if(modificado.tipo!="billingAddress"){$("#tipoDireccionModificar").val("shipingAddress");}if(modificado.tipo=="shippingAddress"){numDirecciones=1;}activarDireccionRecomendada();initBotonesRegistro();$("html, body").animate({scrollTop:$("#confirmarDireccion").find(".error-msg:eq(0)").offset().top-250},600);graciasPorEsperarOff();}});}function activarDireccionRecomendada(){$(".direcctions li").click(function(e){$(this).closest(".form").find(".btn-inactive").removeClass("btn-inactive").removeAttr("disabled");$(".direcctions li.active").removeClass("active");$(this).addClass("active");});}function cancelarValidacion(){var params;if(direccionCambio.tipo=="billingAddress"){direccionFacturacion=direccionCambio;params=obtenerParametrosRegistro(direccionFacturacion,true);}else{direccionEntrega=direccionCambio;params=obtenerParametrosRegistro(direccionEntrega,true);}$("#confirmarDireccion").replaceWith(auxRegistroHtml);initBotonesRegistro();mostrarTogle();validarFormularioDireccion();if($("#general").data("pagina")=="Paso1"||$("#general").data("pagina")=="Registro"||$("#general").data("pagina")=="MiCuentaPost"){desactivarIntroInputDirecciones();}}function aceptarValidacion(){graciasPorEsperar();var params;var tipoEntrega;if((typeof direccionCambio==="undefined")||direccionCambio.tipo=="billingAddress"){aceptarValidacionCampos(direccionFacturacion);params=obtenerParametrosRegistro(direccionFacturacion,true);tipoEntrega="A_DOMICILIO";}else{numDirecciones=2;aceptarValidacionCampos(direccionEntrega);params=obtenerParametrosRegistro(direccionEntrega,true);tipoEntrega="OTRO_DOMICILIO";}if(typeof $("#cambioDireccionBill").val()!=="undefined"){graciasPorEsperar();actualizarDireccionBill();if(numDirecciones=2){actualizarDireccionShip();}var codPostal=$("#codigoPostalList").val();if($("#general").data("pagina")=="Paso1"){$("#general").data("cambioDireccion","true");var idPedido=$("#orderId").val();campoContactInfo=$("#campoContactInfo").val();cambioTiendaAjax({orderId:idPedido,tipoEntrega:tipoEntrega,crearNuevaDireccion:codPostal,originContextPath:"/supermercado"});}else{$("#submitfrmDireccionBill").click();}graciasPorEsperarOff();}else{$.ajax({url:"CancelarValidacion.aspx",data:params,success:mostrarRespuesta}).done(function(){repintarParametrosRegistro();initBotonesRegistro();validarFormularioDireccion();var direccion1=$("#pD1").text();var direccion2=$("#pD2").text();$("#modoEntrega").reload({direccion1:direccion1,direccion2:direccion2},cargarFuncionalidadModoEntrega);});}}function botonLoginRegistro(){}function validarFormularioDireccion(){$("input.requiredD").focusout(function(){buttonStateDireccion(false,"bill");});$("select.requiredD").change(function(){var valueInput=$(this).val();buttonStateDireccion(false,"bill");if($(this).hasClass("options")){if(valueInput=="2"){$(this).closest(".form").find(".formrow.hide").slideDown("200");}else{$(this).closest(".form").find(".formrow.hide").slideUp("200");}}});$("input.requiredD2").focusout(function(){buttonStateDireccion(false,"ship");});$("select.requiredD2").change(function(){var valueInput=$(this).val();buttonStateDireccion(false,"ship");if($(this).hasClass("options")){if(valueInput=="2"){$(this).closest(".form").find(".formrow.hide").slideDown("200");}else{$(this).closest(".form").find(".formrow.hide").slideUp("200");}}});if($("#general").data("pagina")=="Paso1"){activarValidarDireccionFacturacion();}buttonStateDireccion(false,"ship");buttonStateDireccion(false,"bill");}function buttonStateDireccion(validacionCompleta,tipo){var find;var botonActivar;var auxiliarId;if(tipo=="bill"){find="requiredD";auxiliarId="";}else{if(tipo=="fact"){find="requiredF";auxiliarId="F";}else{find="requiredD2";auxiliarId="2";}}var btnInactive=false;var errores=false;$(".form02").find("."+find).each(function(){if($(this).hasClass("disabled")){btnInactive=true;}else{if($(this).hasClass("select01")){if($(this).val()=="0"){btnInactive=true;return btnInactive;}}else{if($(this).attr("id")=="txtnombrevia"){if($(this).val().indexOf(".")!=-1||$(this).val().indexOf(",")!=-1||$(this).val().indexOf(";")!=-1||$(this).val().indexOf(":")!=-1){btnInactive=true;return btnInactive;}}if($(this).val()==""){btnInactive=true;return btnInactive;}if(validacionCompleta){if(validarInputTexto($(this))){errores=true;return errores;}}}}});if(validacionCompleta){if(validarInputTexto($("#txtotrotelefono"+auxiliarId))){errores=true;}}if(!btnInactive){$("#"+tipo).removeAttr("disabled");$("#"+tipo).removeClass("btn-inactive");if(errores==false&&validacionCompleta){if(tipo=="bill"){$("#general").find(".module-content form:eq(0)").find(".error-msg").removeClass("active").css("display","none");}else{$("#general").find(".module-content form:eq(1)").find(".error-msg").removeClass("active").css("display","none");}}}else{$("#"+tipo).attr("disabled","disabled");$("#"+tipo).addClass("btn-inactive");errores=btnInactive;}return errores;}function validarInputTexto(elemento){var errores=false;if(elemento.hasClass("largoMin")){if(comprobarFalloLongitud(elemento)){colocarError(elemento);errores=true;return errores;}else{borrarError(elemento);}}if(elemento.hasClass("number")){if(elemento.val()!=""){if(!esNumero(elemento.val())){errores=true;colocarError(elemento);}else{borrarError(elemento);}}}return errores;}function validarEmail(elemento){var valueInput=elemento.val();var emailReg=/^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/;if(valueInput==""||!emailReg.test(valueInput)){if(!$(this).hasClass("disabled")){$(this).addClass("error");colocarError(elemento);return false;}else{$(this).removeClass("error");}}else{$(this).removeClass("error");}return true;}function comprobarFalloLongitud(elemento){var long1=elemento.attr("data-long");var texto=elemento.val();if(texto.length<long1&&texto.length!=0){if(!elemento.hasClass("error")){elemento.addClass("error");}return true;}return false;}function esNumero(texto){if($.isNumeric(texto)){return true;}else{return false;}}function obtenerParametrosRegistro(modificado,noValidar){var origen=$("#general").data("pagina");return{noValidar:noValidar,address:modificado.tipo,"billingAddress.routeType":direccionFacturacion.routeType,"billingAddress.address1":direccionFacturacion.address1,"billingAddress.address2":direccionFacturacion.address2,"billingAddress.city":direccionFacturacion.city,"billingAddress.postalCode":direccionFacturacion.postalCode,"billingAddress.province":direccionFacturacion.province,"shippingAddress.routeType":direccionEntrega.routeType,"shippingAddress.address1":direccionEntrega.address1,"shippingAddress.address2":direccionEntrega.address2,"shippingAddress.city":direccionEntrega.city,"shippingAddress.postalCode":direccionEntrega.postalCode,"shippingAddress.province":direccionEntrega.province,numDirecciones:numDirecciones,origen:origen};}function repintarParametrosRegistro(){$("#modoEntrega").text("");$("#txturbanizacion").val(direccionFacturacion.urbanizacion);$("#txtbloque").val(direccionFacturacion.bloque);$("#txtescalera").val(direccionFacturacion.escalera);$("#txtpiso").val(direccionFacturacion.piso);$("#txtpuerta").val(direccionFacturacion.puerta);$("#txttelefono").val(direccionFacturacion.telefono);$("#txtotrotelefono").val(direccionFacturacion.telefono2);$("#txtinformacion").val(direccionFacturacion.informacion);$("#txturbanizacion2").val(direccionEntrega.urbanizacion);$("#txtbloque2").val(direccionEntrega.bloque);$("#txtescalera2").val(direccionEntrega.escalera);$("#txtpiso2").val(direccionEntrega.piso);$("#txtpuerta2").val(direccionEntrega.puerta);$("#txttelefono2").val(direccionEntrega.telefono);$("#txtotrotelefono2").val(direccionEntrega.telefono2);$("#txtinformacion2").val(direccionEntrega.informacion);$('#txtprovincia option[value="'+direccionFacturacion.province+'"]').attr("selected","selected");$('#txtprovincia2 option[value="'+direccionEntrega.province+'"]').attr("selected","selected");}function actualizarDireccionBill(){$("#secondAddress").val("false");$("#routeTypeBill").val(direccionFacturacion.routeType);$("#address1Bill").val(direccionFacturacion.address1);$("#address2Bill").val(direccionFacturacion.address2);$("#urbanizationBill").val(direccionFacturacion.urbanizacion);$("#blockBill").val(direccionFacturacion.bloque);$("#stairsBill").val(direccionFacturacion.escalera);$("#floorBill").val(direccionFacturacion.piso);$("#doorBill").val(direccionFacturacion.puerta);$("#cityBill").val(direccionFacturacion.city);$("#provinceBill").val(direccionFacturacion.province);$("#postalCodeBill").val(direccionFacturacion.postalCode);$("#phoneNumberBill").val(direccionFacturacion.telefono);$("#phoneNumber2Bill").val(direccionFacturacion.telefono2);$("#infoForTransporterBill").val(direccionFacturacion.informacion);$("#normalizadaBill").val(direccionFacturacion.normalizada);$("#coordYBill").val(direccionFacturacion.coordYBill);$("#coordXBill").val(direccionFacturacion.coordXBill);$("#seccionCensalBill").val(direccionFacturacion.seccionCensal);}function recargarDireccionBill(){direccionFacturacion={tipo:"billingAddress",routeType:$("#routeTypeBill").val(),address1:$("#address1Bill").val(),address2:$("#address2Bill").val(),city:$("#cityBill").val(),postalCode:$("#postalCodeBill").val(),province:$("#provinceBill").val(),urbanizacion:$("#urbanizationBill").val(),bloque:$("#blockBill").val(),escalera:$("#stairsBill").val(),piso:$("#floorBill").val(),puerta:$("#doorBill").val(),telefono:$("#phoneNumberBill").val(),telefono2:$("#phoneNumber2Bill").val(),informacion:$("#infoForTransporterBill").val(),normalizada:$("#normalizadaBill").val(),coordYBill:$("#coordYBill").val(),coordXBill:$("#coordXBill").val(),seccionCensal:$("#seccionCensalBill").val(),normalizadaAux:true,creada:true};}function actualizarDireccionShip(){$("#secondAddress").val("true");$("#routeTypeShip").val(direccionEntrega.routeType);$("#address1Ship").val(direccionEntrega.address1);$("#address2Ship").val(direccionEntrega.address2);$("#urbanizationShip").val(direccionEntrega.urbanizacion);$("#blockShip").val(direccionEntrega.bloque);$("#stairsShip").val(direccionEntrega.escalera);$("#floorShip").val(direccionEntrega.piso);$("#doorShip").val(direccionEntrega.puerta);$("#cityShip").val(direccionEntrega.city);$("#provinceShip").val(direccionEntrega.province);$("#postalCodeShip").val(direccionEntrega.postalCode);$("#phoneNumberShip").val(direccionEntrega.telefono);$("#phoneNumber2Ship").val(direccionEntrega.telefono2);$("#infoForTransporterShip").val(direccionEntrega.informacion);$("#normalizadaShip").val(direccionEntrega.normalizada);$("#coordYShip").val(direccionEntrega.coordYBill);$("#coordXShip").val(direccionEntrega.coordXBill);$("#seccionCensalShip").val(direccionEntrega.seccionCensal);}function recargarDireccionShip(){direccionEntrega={tipo:"shipingAddress",routeType:$("#routeTypeShip").val(),address1:$("#address1Ship").val(),address2:$("#address2Ship").val(),city:$("#cityShip").val(),postalCode:$("#postalCodeShip").val(),province:$("#provinceShip").val(),urbanizacion:$("#urbanizationShip").val(),bloque:$("#blockShip").val(),escalera:$("#stairsShip").val(),piso:$("#floorShip").val(),puerta:$("#doorShip").val(),telefono:$("#phoneNumberShip").val(),telefono2:$("#phoneNumber2Ship").val(),informacion:$("#infoForTransporterShip").val(),normalizada:$("#normalizadaShip").val(),coordYBill:$("#coordYShip").val(),coordXBill:$("#coordXShip").val(),seccionCensal:$("#seccionCensalShip").val(),normalizadaAux:true,creada:true};}function aceptarValidacionCampos(modificar){modificar.routeType=$("#tipoRutaList").val();modificar.address1=$("#address1List").val();modificar.address2=$("#address2List").val();modificar.postalCode=$("#codigoPostalList").val();modificar.city=$("#ciudadList").val();modificar.normalizada=$("#normalizadaList").val();modificar.normalizadaAux=true;}function colocarErrorServidorDireccion(identificador){if(!$("#errDireccion").hasClass("error")){$("#errDireccion").addClass("error");}colocarErrorFaltaElemento(identificador);}function colocarErrorServidorDireccion(identificador,error){if(!$("#"+error).hasClass("error")){$("#"+error).addClass("error");}colocarErrorFaltaElemento(identificador);}function colocarError(elemento){if(!elemento.hasClass("error")){elemento.addClass("error");}mostrarAnimacionError(elemento);}function mostrarAnimacionError(elemento){var error=$("#"+elemento.attr("data-error"));if(error.hasClass("hide")){error.removeClass("hide");}error.parent().slideDown("fast").addClass("active");$("html, body").animate({scrollTop:elemento.closest(".form").find(".error-msg:eq(0)").offset().top-250},600);}function mostrarAnimacionQuitarError(elemento){var error=$("#"+elemento.attr("data-error"));if(!error.hasClass("hide")){error.addClass("hide");}}function borrarError(elemento,clase){if(elemento.hasClass("error")){elemento.removeClass("error");}mostrarAnimacionQuitarError(elemento);}function cambioValidacionDireccion(tipoRuta,address1,address2,codigoPostal,ciudad,normalizada){$("#tipoRutaList").val(tipoRuta);$("#address1List").val(address1);$("#address2List").val(address2);$("#codigoPostalList").val(codigoPostal);$("#ciudadList").val(ciudad);$("#normalizadaList").val(normalizada);}function initBotonesRegistro(){$(".btn01").click(function(e){e.preventDefault();});}function calcularNumeroDirecciones(){if($("#secondAddress").val()=="true"){numDirecciones=2;}}function initLocale(){var locale=$("#nav-languages ul").data("locale");var localeAct=$("#nav-languages ul").find("a[data-locale='"+locale+"']");localeAct.activa();$("#nav-languages ul").parent().find("span").text(localeAct.text());$("#nav-languages ul a").click(function(e){$("#idioma").val($(this).data("locale"));$("#fl-pagina").val($("#general").data("pagina"));if($("#general").data("pagina")=="BusquedaResultados"){$("#fl-id").val($("#general").data("busqueda"));}else{$("#fl-id").val($("#general").data("id"));}$("#submitSeleccionIdioma").click();});}function cargarFancyPlay(){if($(".fancyPlay").length){$(".fancyPlay").click(function(){$.fancybox({transitionIn:"fade",transitionOut:"fade",speedIn:400,speedOut:400,autoDimensions:false,overlayShow:true,overlayColor:"#fff",titlePosition:"over",titleShow:false,centerOnScroll:true,title:this.title,width:680,height:495,href:this.href.replace(new RegExp("watch\\?v=","i"),"v/"),type:"swf",swf:{wmode:"transparent",allowfullscreen:"true"},helpers:{title:null,overlay:{locked:false}}});return false;});}}function cargarCollapsibleSeleccionado(){$(".collapsible").click(function(e){if(!$(this).parent().hasClass(".btn02")){e.preventDefault();var idContent=$(this).attr("href");$(this).toggleClass("open");$(idContent).slideToggle("slow",function(){$(idContent).toggleClass("active");});}});}function cargarCollapsible(){$(".collapsible").click(function(e){if(!$(this).parent().hasClass(".btn02")){e.preventDefault();var idContent=$(this).attr("href");$(this).toggleClass("open");$(idContent).slideToggle("slow",function(){$(idContent).toggleClass("active");});}});if($(".collapsible-content").length){$(".collapsible:eq(0)").click();}}function comprobarFormulario(elemento){var formulario=elemento.parents("form");validacionFormulario(formulario);var aux=formulario.find(".error").length;if(aux>0){return false;}else{if($(".errornoclave").length>0){return false;}}return true;}function validacionFormulario(formulario){if(comprobarMail($("#Email2"))){eliminarErroresLoginRegistro(formulario);}else{if($("#password2").hasClass("error")){$("#password2").removeClass("error");}}}function comprobarMail(elemento){var valueInput=elemento.val();var emailReg=/^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/;if(valueInput===undefined){return true;}if(valueInput==""||valueInput.length==0){if(!elemento.hasClass("error")){elemento.addClass("error");}eliminarErroresLoginRegistro(elemento);elemento.parents(".module-content").find("ul[data-error='errorLoginVacio']").slideDown("fast").addClass("active");return false;}else{if(!emailReg.test(valueInput)){if(!elemento.hasClass("error")){elemento.addClass("error");}eliminarErroresLoginRegistro(elemento);elemento.parents(".module-content").find("ul[data-error='errorLogin']").slideDown("fast").addClass("active");return false;}else{if(elemento.hasClass("error")){elemento.removeClass("error");eliminarErroresLoginRegistro(elemento);}return true;}}}function comprobarPass(elemento){var valueInput=elemento.val();if(valueInput==""||valueInput.length==0){if(!elemento.hasClass("error")){elemento.addClass("error");eliminarErroresLoginRegistro(elemento);elemento.parents(".module-content").find("ul[data-error='errorLoginPass']").slideDown("fast").addClass("active");}return false;}else{if(elemento.hasClass("error")){elemento.removeClass("error");}return true;}}function eliminarErroresLoginRegistro(elemento){elemento.parents(".module-content:eq(0)").find(".error-msg.active").each(function(){$(this).slideUp("fast").removeClass("active");});}function cambiarMetadatosSEO(id){var params;if(id!=null){params={id:id,localizacion:$("#general").data("pagina"),idioma:$("#idioma").val()};}else{params={id:id,localizacion:"genericoSEO",idioma:$("#idioma").val()};}$.ajax({url:"ObtenerDatosSEO.aspx",data:params,dataType:"json",success:function(data){if(matched.browser=="msie"&&matched.version<9){document.title=data.datosSeo.titulo;}else{$("title").html(data.datosSeo.titulo);}$("meta[name=Description]").attr("content",data.datosSeo.descripcion);}});}function guardarXTpage(xtpage,xtn2){$("#recargarCuwa").data("xtpage",xtpage);}function ejecutarXTclick(p1,level,tipo){var xtpage=$("#recargarCuwa").data("xtpage");if(xtpage==null){xtpage="Home";}if(typeof xt_click=="function"){xt_click(this,p1,level,xtpage,tipo);}}function initSelectExplorer(elem){if(matched.browser=="msie"&&matched.version<9){var span=$($(elem).parents()[0]).find("span");elem.css("padding-top","3px");elem.css("padding-bottom","10px");}}function selectExplorer(elem){if(matched.browser=="msie"&&matched.version<9){var span=$($(elem).parents()[0]).find("span");elem.css("padding-top","7px");elem.css("padding-bottom","10px");}}function initCheckExplorer(elem){if(matched.browser=="msie"&&matched.version<9){var pagina=$("#general").data("pagina");var span="";if(pagina=="BienvenidaDirecciones"||pagina=="Paso2"||pagina=="MiCuentaPost"||pagina=="Registro"||pagina=="Paso1"||pagina=="PrevioMiCuenta"){span=$(elem).next();}if($(elem).prop("checked")){span.css("background-position","0px -1px");}else{span.css("background-position","0px -101px");}}}function posicionarIndisponibilidad(){$("#module-indisponibilidad").html($("#indisponibilidad").html());$("#indisponibilidad").remove();}function tramoSiguienteCambiarFranjas(tienda,pedido,cp){graciasPorEsperar();var paginaActual=parseInt($("#paginaActual").val());if(isNaN(paginaActual)){paginaActual=1;}else{paginaActual=paginaActual+1;}$("#module-indisponibilidad").html("");$.ajax({url:"CambiarHorariosEntrega.aspx",data:{pedido:pedido,salePointPedido:tienda,codigoPostalPedido:cp,paginaActual:paginaActual,tramoSigAnt:"1"},type:"POST",dataType:"html",}).done(function(data){var contentInner=$($.parseHTML(data));var contentProject=$("#content-inner",contentInner).html();$(".layer-content-inner #content-inner").html(contentProject);initCambiarFranjaPopup();graciasPorEsperarOff();});}function tramoAnteriorCambiarFranjas(tienda,pedido,cp){graciasPorEsperar();var paginaActual=parseInt($("#paginaActual").val());if(isNaN(paginaActual)){paginaActual=0;}else{paginaActual=paginaActual-1;}$("#module-indisponibilidad").html("");$.ajax({url:"CambiarHorariosEntrega.aspx",data:{pedido:pedido,salePointPedido:tienda,codigoPostalPedido:cp,paginaActual:paginaActual,tramoSigAnt:"0"},type:"POST",dataType:"html",}).done(function(data){var contentInner=$($.parseHTML(data));var contentProject=$("#content-inner",contentInner).html();$(".layer-content-inner #content-inner").html(contentProject);initCambiarFranjaPopup();graciasPorEsperarOff();});}function checkExplorer(elem){var pagina=$("#general").data("pagina");if(matched.browser=="webkit"&&matched.version<"6"&&pagina=="Bienvenida"){var inputSafari=$(elem).closest("label").find("input.checkbox01");if(inputSafari.prop("checked")){$(elem).css("background-position","0px -101px");}else{$(elem).css("background-position","0px -1px");}}if(matched.browser=="msie"&&matched.version<9){if(pagina=="Paso1"){if($(elem).parent().find("input[name='horaEntrega']").length=="1"){var tabla=$("#actsemana");$("#actsemana").find("label.fancyradio span").css("background-position","0px -101px");}}if(pagina=="PedidosAnteriores"){if($(elem).parent().find("input[name='cambiarHoraEntrega']").length=="1"){var tabla=$("#cambiarFranjaTabla");$("#cambiarFranjaTabla").find("label.fancyradio span").css("background-position","0px -101px");}}if(pagina=="Paso2"){var input=$(elem).parent().find("input.radio01");var id=input.attr("id");if(!input.prop("checked")){$(elem).css("background-position","0px -1px");}if(id=="tarjeta"){$("#Paypal").parent().find("span").first().css("background-position","0px -101px");}if(id=="Paypal"){$("#tarjeta").parent().find("span").first().css("background-position","0px -101px");}}if($(".fancyradio[for='radio-4']").length>0&&$(".fancyradio[for='radio-4']").length>0){for(var i=1;i<=5;i++){$(".fancyradio[for='radio-"+i+"']").find("span").css("background-position","0px -101px");}}var input=$(elem).closest("label").find("input.checkbox01").prop("checked");if(input){$(elem).css("background-position","0px -101px");}else{$(elem).css("background-position","0px -1px");}if(pagina=="BienvenidaDirecciones"||pagina=="MiCuentaPost"||pagina=="Registro"||pagina=="Paso1"){var id=$(elem).closest("label").find("input").attr("id");if(id=="envioDireccion"){$(".fancyradio[for='recoger']").find("span").css("background-position","0px -101px");}else{if(id=="recoger"){$(".fancyradio[for='envioDireccion']").find("span").css("background-position","0px -101px");}}if(id=="direccion01"){$(".fancyradio[for='direccion02']").find("span").first().css("background-position","0px -101px");}else{if(id=="direccion02"){$(".fancyradio[for='direccion01']").find("span").first().css("background-position","0px -101px");}}if(id=="Particular"){$(".fancyradio[for='Empresa']").find("span").css("background-position","0px -101px");}else{if(id=="Empresa"){$(".fancyradio[for='Particular']").find("span").css("background-position","0px -101px");}}}}}function avisoLegalCuwa(){$.post("CargaCuwaAvisoLegal.aspx",{pagina:"aviso legal"},function(respuesta){var trozos=respuesta.split(";");pagina=trozos[0].trim();xtnv=document;xtpage=trozos[1].trim();xtsd=trozos[2].trim();xtsite=trozos[3].trim();xtn2=trozos[4].trim();xtdi="0";xt_multc=trozos[5].trim();xt_an=trozos[6].trim();xt_ac=trozos[7].trim();window.xtparam=xt_multc+"&ac="+xt_ac+"&an="+xt_an;var xtcore=document.createElement("script");xtcore.setAttribute("type","text/javascript");xtcore.setAttribute("src","/supermercado/201510290505/_style/_js/xtcore.js");document.getElementsByTagName("head")[0].appendChild(xtcore);});}function mostrarSesionExpirada(){if($("#layer-content").length>0){$("#layer-content").fadeOut("300",function(){mostrarSesionExpiradaPopUp();$("#layer-content").remove();});}else{mostrarSesionExpiradaPopUp();}}function mostrarSesionExpiradaPopUp(){startAnimation();var urlLayer="BienvenidaTimeOut.aspx";$("#general").append('<div class="auxPopUpRepetidos"><div class="big" id="layer-content"><div class="layer-background"></div><div class="layer-content-inner"><div id="content-inner"></div><a href="#" class="close-layer"><span>Cerrar capa</span></a></div></div></div>');if(matched.browser=="msie"&&matched.version<9){$("#general #layer-content").css("display","none");}ajaxLayer(urlLayer);}function avisocookies(){var valnormcookie=getCookie("normativacookie");if(valnormcookie==null||valnormcookie!="no"){$("#contenidoavisocookies").slideDown("fast");if(!$("#basketContent").hasClass("avisoCookiesActivo")){$("#basketContent").addClass("avisoCookiesActivo");}if(!$("#lista02").hasClass("avisoCookiesActivoLista")){$("#lista02").addClass("avisoCookiesActivoLista");}}else{$("#contenidoavisocookies").slideUp("fast");if($("#basketContent").hasClass("avisoCookiesActivo")){$("#basketContent").removeClass("avisoCookiesActivo");}if($("#lista02").hasClass("avisoCookiesActivoLista")){$("#lista02").removeClass("avisoCookiesActivoLista");}}}function cerrarhtmlcapacontenidoaviso(){var duracionCookie=$("#contenidoavisocookies").data("duracionCookie");var dominio=$("#contenidoavisocookies").data("dominioCookie");setCookie("normativacookie","no",duracionCookie,"/",dominio);$("#contenidoavisocookies").slideUp("200");}function setCookie(c_name,value,exdays,ruta,dominio,segura){var exdate=new Date();exdate.setDate(exdate.getDate()+parseInt(exdays));var c_value=escape(value)+((exdays==null)?"":"; expires="+exdate)+";path="+escape(ruta);document.cookie=c_name+"="+c_value;}function getCookie(c_name){var i,x,y,ARRcookies=document.cookie.split(";");for(i=0;i<ARRcookies.length;i++){x=ARRcookies[i].substr(0,ARRcookies[i].indexOf("="));y=ARRcookies[i].substr(ARRcookies[i].indexOf("=")+1);x=x.replace(/^\s+|\s+$/g,"");if(x==c_name){return unescape(y);}}}function cancelarClick(elemento){if($("#loginDesdeAction").val()=="false"){return false;}if($("#general").data("pagina")=="Estatico"){if(elemento.parents("#contentSection").length>0){return false;}}if(elemento.hasClass("enlaceClick")||elemento.hasClass("btn-less")||elemento.hasClass("btn-more")){return false;}if(elemento.parents("div#footer-c").length>0){return false;}if(esUrlBloquearClick(elemento)){if(elemento.attr("href")!==undefined&&(elemento.attr("href").indexOf("http://www.carrefouronline.carrefour.es/supermercado/")==0)){return false;}}proximoClick=null;var parent=elemento.parents("form");if(parent!==undefined&&parent.attr("action")=="/supermercado/CarritoBotones.aspx"){var urlRedireccionar=elemento.parents("li").find(".info-product .verProducto").attr("href");$("#loginDesdeAction").data("hrefRedirect",urlRedireccionar);}else{if(elemento.attr("href")!==undefined&&elemento.data("promo")===undefined){if(elemento.hasClass("horariosEntrega")){$("#loginDesdeAction").data("hrefRedirect","Home.aspx?origen=horariosEntrega");}else{$("#loginDesdeAction").data("hrefRedirect",elemento.attr("href"));}}else{if(elemento.data("promo")!==undefined){$("#loginDesdeAction").data("hrefRedirect","Promocion.aspx?id="+elemento.data("promo"));}else{if(elemento.parents(".searchbox").length>0){$("#loginDesdeAction").data("hrefRedirect","BusquedaResultados.aspx?id="+$("#txtSearch").val());}}}}if($("#layer-content").length==0){$("#enlaceIdentificaOculto").click();}return true;}function esUrlBloquearClick(elemento){if(elemento.parents("#nav-products").length==0&&elemento.parents("#basketContent").length==0&&elemento.parents("#nav-search").length==0&&elemento.parents("#footer-a-inner").length==0&&elemento.parents("#nav-ofertas").length==0){return true;}return false;}function activarPopUpClick(){$("a").on("click",function(e){if(cancelarClick($(this))){e.stopPropagation();return false;}});$("button").on("click",function(e){if(cancelarClick($(this))){e.stopPropagation();return false;}});$("input").on("click",".submit",function(e){if(cancelarClick($(this))){alert("asdf");e.stopPropagation();return false;}});}function redireccionarBienvenida(){if($("#general").data("pagina")=="Estatico"||$("#general").data("pagina")=="Home"||$("#general").data("pagina")=="PreRegistro"||$("#general").data("pagina")=="Registro"){return false;}return true;}function validacionFormularioBienvenida(formulario){var valueInput=$("#codigoPostal").val();var errores=false;if(valueInput==""){errores=true;}else{if(!esNumero(valueInput)){errores=true;}else{if(valueInput.length<5){errores=true;}}}if(errores){if(!$("#codigoPostal").hasClass("error")){$("#codigoPostal").addClass("error");formulario.parents(".module-content:eq(0)").find(".error-msg").slideDown("fast").addClass("active");}}else{if($("#codigoPostal").hasClass("error")){formulario.parents(".module-content:eq(0)").find(".error-msg").slideUp("fast").removeClass("active");$("#codigoPostal").removeClass("error");}}return !errores;}function errorCodPostal(){$("#load-layer").fadeIn("200");urlLayer="BienvenidaCodigoPostalError.aspx";$("#general").append('<div id="layer-content"><div class="layer-background"></div><div class="layer-content-inner"><div id="content-inner" class="avisoNoTiendaPopUp"></div><a href="#" class="close-layer"><span>Cerrar capa</span></a></div></div>');if(matched.browser=="msie"&&matched.version<9){$("#general #layer-content").addClass("hide");}$("#general").data("noServimosCodPostal","true");ajaxLayer(urlLayer);startAnimation();}function loginInvitadoTienda(){$("#bienvenidaVisitanteSubmit").click();}function mostrarCapaTarifasPlanas(e){var pagina=$("#general").data("pagina");var enlace=$(this);enlace=$(e.target);e.preventDefault();var posTop=enlace.offset().top-11;var posLeft=enlace.offset().left-25;var posTop02;enlace.fadeOut("200",function(){if(!$(".list-elem.hide").length){enlace.addClass("hide");}else{enlace.addClass("rdb");$(".list-elem.hide").fadeIn("200",function(){enlace.removeClass("hide");$(".list-elem.rdb").addClass("hide").removeClass("rdb");});}});$("#listaTarifasPlanas").fadeOut("200",function(){$("#listaTarifasPlanas").removeClass("show");$("#listaTarifasPlanas").css("top",posTop).css("left",posLeft);$("#listaTarifasPlanas").fadeIn("200",function(){$("#listaTarifasPlanas").addClass("show");});});$("html, body").animate({scrollTop:posTop02},600);}function ocultarCapaListasTarifaPlana(){$("#listaTarifasPlanas").delay(200).fadeOut("200",function(){$("#listaTarifasPlanas").removeClass("show");$(".tarifaPlanaComprar").fadeIn("200",function(){$(this).removeClass("hide");});$("#lista .fancyradio span").css("background-position","0 -100px");});}function addTarifaPlana(tarifaId,sustituir,paso1){$.ajax({url:"AddTarifaCarrito.aspx",data:{tarifaPlanaId:tarifaId,sustituir:sustituir,paso1:paso1},dataType:"json",success:function(data){if(data.respuesta==0){$("#layerInfoAddTarifaPlana").reload({tarifaPlanaId:tarifaId},function(e){infoAddGenerico($("#lista06"));});reloadDetalleCarrito();}else{if(data.respuesta==1){window.location="ProcesoPago.aspx?levantarPopupTarifa="+tarifaId;}else{if(data.respuesta==2){popupAlert("label.aviso","label.tarifaPlana.addConTarifaUsuario");}else{if(data.respuesta==3){confirmacion("label.aviso","label.tarifaPlana.addConTarifaOrder","",function(){$("#botonNoVentanaConfirmacion").click();addTarifaPlana(tarifaId,"true");});}}}}}});}function infoAddGenerico(listaMostrar){var valnormcookie=getCookie("normativacookie");var posLeft=$("#content-inner").offset().left+250;var posTop;if($("#general").hasClass("sticky-header")){if(valnormcookie==null||valnormcookie!="no"){posTop=$(window).scrollTop()+210;}else{posTop=$(window).scrollTop()+130;}}else{if($("#general").data("pagina")=="Paso1"){if(valnormcookie==null||valnormcookie!="no"){posTop=$(window).scrollTop()+180;}else{posTop=$(window).scrollTop()+180;}}else{if(valnormcookie==null||valnormcookie!="no"){posTop=$(window).scrollTop()+290;}else{posTop=$(window).scrollTop()+210;}}}listaMostrar.css("top",posTop).css("left",posLeft);listaMostrar.fadeIn("200");setTimeout(function(){listaMostrar.fadeOut("200");},2000);}function comprobarMostraragregarListaACesta(){if($("#mostrarPopup").length>0){if($("#mostrarPopup").data("pop-up")!==undefined&&$("#mostrarPopup").data("pop-up")=="corteTextil"){var nombre=$("#mostrarPopup").data("nombreLista");$("#layerInfoAddListaCesta").reload({nombreLista:nombre},function(e){infoAddListaCesta();$("#mostrarPopup").removeData("pop-up");$("#mostrarPopup").removeData("nombreLista");});}}}function actualizarEnvioFactura(){$("#receivesBills").click(function(){var valor;if($("#receivesBills").is(":checked")){valor="true";}else{valor="false";}graciasPorEsperar();$.ajax({url:"CambioUsuarioRecibirFacturas.aspx",data:{bills:valor},type:"POST",success:function(data){if($("#general").data("pagina")=="Paso1"){if($("#receivesBills").is(":checked")){$(".facturacionPaso1.hide").slideDown("fast",function(e){$(".facturacionPaso1.hide").removeClass("hide");});}else{$(".facturacionPaso1").slideUp("fast",function(e){$(".facturacionPaso1").addClass("hide");});}}graciasPorEsperarOff();},error:function(data){graciasPorEsperarOff();}});});}function isNumeric(input){var regexp=/^[0-9]+$/;return regexp.test(input);}